diff --git a/agents-scr/Makefile.am b/agents-scr/Makefile.am
deleted file mode 100644
index a2c2946..0000000
--- a/agents-scr/Makefile.am
+++ /dev/null
@@ -1,12 +0,0 @@
-#
-# Makefile.am for storage/agents-scr
-#
-
-scrconf_DATA = etc_cryptotab.scr	\
-	       etc_mtab.scr		\
-	       proc_dasddev.scr		\
-	       proc_partitions.scr	\
-	       proc_swaps.scr		\
-	       sysconfig_storage.scr
-
-EXTRA_DIST = $(scrconf_DATA)
diff --git a/data/Makefile.am b/data/Makefile.am
deleted file mode 100644
index 1e7e401..0000000
--- a/data/Makefile.am
+++ /dev/null
@@ -1,9 +0,0 @@
-#
-# Makefile.am for storage/data
-#
-
-fillup_DATA = sysconfig.storage-yast2-storage
-
-EXTRA_DIST = $(fillup_DATA)
-
-include $(top_srcdir)/Makefile.am.common
diff --git a/disk/Makefile.am b/disk/Makefile.am
deleted file mode 100644
index a04d172..0000000
--- a/disk/Makefile.am
+++ /dev/null
@@ -1,5 +0,0 @@
-#
-# Makefile.am for storage/disk
-#
-
-SUBDIRS = src
diff --git a/disk/src/Makefile.am b/disk/src/Makefile.am
deleted file mode 100644
index 69ea25b..0000000
--- a/disk/src/Makefile.am
+++ /dev/null
@@ -1,12 +0,0 @@
-#
-# Makefile.am for storage/disk/src
-#
-
-client_DATA =			\
-	storage.ycp		\
-	disk.ycp		\
-	disk_worker.ycp
-
-desktop_DATA = disk.desktop
-
-EXTRA_DIST = $(client_DATA) $(desktop_DATA)
diff --git a/doc/Makefile.am b/doc/Makefile.am
index e34ad2b..60ebcd3 100644
--- a/doc/Makefile.am
+++ b/doc/Makefile.am
@@ -1,8 +1,8 @@
 #
 # Makefile.am for storage/storage/doc
 #
-
-SUBDIRS = autodocs
+# TODO autodocs not yet support ruby
+# SUBDIRS = autodocs
 
 htmldir = $(docdir)
 
diff --git a/multipath-simple/Makefile.am b/multipath-simple/Makefile.am
deleted file mode 100644
index 77cf4ba..0000000
--- a/multipath-simple/Makefile.am
+++ /dev/null
@@ -1,5 +0,0 @@
-#
-# Makefile.am for storage/multipath-simple
-#
-
-SUBDIRS = src
diff --git a/multipath-simple/src/Makefile.am b/multipath-simple/src/Makefile.am
deleted file mode 100644
index 7585ae1..0000000
--- a/multipath-simple/src/Makefile.am
+++ /dev/null
@@ -1,8 +0,0 @@
-#
-# Makefile.am for storage/multipath-simple/src
-#
-
-client_DATA =			\
-	multipath-simple.ycp
-
-EXTRA_DIST = $(client_DATA)
diff --git a/scripts/Makefile.am b/scripts/Makefile.am
deleted file mode 100644
index 3795ef4..0000000
--- a/scripts/Makefile.am
+++ /dev/null
@@ -1,8 +0,0 @@
-#
-# Makefile.am for storage/scripts
-#
-
-ybin_SCRIPTS =			\
-	check.boot
-
-EXTRA_DIST = $(ybin_SCRIPTS)
diff --git a/src/include/partitioning/auto_part_create.ycp b/src/include/partitioning/auto_part_create.ycp
index a2a68e6..7e81d58 100644
--- a/src/include/partitioning/auto_part_create.ycp
+++ b/src/include/partitioning/auto_part_create.ycp
@@ -23,7 +23,7 @@
  * Module:		auto_part_create.ycp
  *
  * Authors:		Andreas Schwab (schwab@suse.de)
- *			Klaus K‰mpf (kkaempf@suse.de)
+ *			Klaus K√§mpf (kkaempf@suse.de)
  *
  * Purpose:		This module creates the neccessary partitions
  *			in the targetMap
diff --git a/src/include/partitioning/auto_part_functions.ycp b/src/include/partitioning/auto_part_functions.ycp
index 28bd406..2227df2 100644
--- a/src/include/partitioning/auto_part_functions.ycp
+++ b/src/include/partitioning/auto_part_functions.ycp
@@ -23,7 +23,7 @@
  * Module: 		auto_part_functions.ycp
  *
  * Authors: 		Andreas Schwab (schwab@suse.de)
- *			Klaus K‰mpf (kkaempf@suse.de)
+ *			Klaus K√§mpf (kkaempf@suse.de)
  *
  * Purpose: 		This module define functions of general use
  *			to the automatic partitioner
@@ -175,8 +175,8 @@ define boolean is_fat_partition( map partition ) ``{
     //
 define boolean is_ntfs_partition( map partition ) ``{
 	return ( partition["fsid"]:-1 == 0x07 || 	// HPFS/NTFS
-		 partition["fsid"]:-1 == 0x86 || 	// NTFS-Datentr‰ger
-		 partition["fsid"]:-1 == 0x87 );	// NTFS-Datentr‰ger
+		 partition["fsid"]:-1 == 0x86 || 	// NTFS-Datentr√§ger
+		 partition["fsid"]:-1 == 0x87 );	// NTFS-Datentr√§ger
     }
 
     
diff --git a/src/include/partitioning/auto_part_prepare.ycp b/src/include/partitioning/auto_part_prepare.ycp
index 57c21ab..baa6eb5 100644
--- a/src/include/partitioning/auto_part_prepare.ycp
+++ b/src/include/partitioning/auto_part_prepare.ycp
@@ -23,7 +23,7 @@
  * Module: 		auto_part_prepare.ycp
  *
  * Authors: 		Andreas Schwab (schwab@suse.de)
- *			Klaus K‰mpf (kkaempf@suse.de)
+ *			Klaus K√§mpf (kkaempf@suse.de)
  *
  * Purpose: 		This module preparse the raw targetMap to
  *			cover the whole disk, including unpartitioned
@@ -36,6 +36,7 @@
 textdomain "storage";
 
 import "Partitions";
+import "StorageProposal";
 
 define list<map> prepare_partitions( map target, list<map> partitions )
     ``{
diff --git a/src/include/partitioning/auto_part_ui.ycp b/src/include/partitioning/auto_part_ui.ycp
index f62e625..be693e3 100644
--- a/src/include/partitioning/auto_part_ui.ycp
+++ b/src/include/partitioning/auto_part_ui.ycp
@@ -23,7 +23,7 @@
  * Module: 		auto_part_ui.ycp
  *
  * Authors: 		Andreas Schwab (schwab@suse.de)
- *			Klaus K‰mpf (kkaempf@suse.de)
+ *			Klaus K√§mpf (kkaempf@suse.de)
  *
  * Purpose: 		This module contains the user interface
  *			definitions for the automatic partitioner
@@ -48,6 +48,7 @@
     import "Partitions";
     import "Popup";
     import "Product";
+    import "Storage";
     import "StorageProposal";
 
     // --------------------------------------------------------------
diff --git a/src/include/partitioning/custom_part_lib.ycp b/src/include/partitioning/custom_part_lib.ycp
index 2e01fa7..4c30b07 100644
--- a/src/include/partitioning/custom_part_lib.ycp
+++ b/src/include/partitioning/custom_part_lib.ycp
@@ -42,10 +42,15 @@
   textdomain "storage";
   import "Mode";
   import "Arch";
+  import "Label";
+  import "Package";
   import "Partitions";
+  import "Popup";
   import "Product";
   import "FileSystems";
   import "Greasemonkey";
+  import "Stage";
+  import "Storage";
 
   include "partitioning/partition_defines.ycp";
 
diff --git a/src/include/partitioning/ep-all.ycp b/src/include/partitioning/ep-all.ycp
index 2787c17..f4d3ea5 100644
--- a/src/include/partitioning/ep-all.ycp
+++ b/src/include/partitioning/ep-all.ycp
@@ -30,6 +30,10 @@
 {
     textdomain "storage";
 
+    import "Arch";
+    import "Event";
+    import "Mode";
+    import "Greasemonkey";
     import "PackageCallbacks";
     import "PackageSystem";
 
@@ -37,6 +41,16 @@
     void CreateAllPanel(any user_data)
     {
 
+    import "ProductFeatures";
+    import "Stage";
+    import "Storage";
+    import "StorageIcons";
+    import "StorageFields";
+    import "StorageSettings";
+    import "Hostname";
+    import "Wizard";
+    import "Popup";
+    import "TreePanel";
 	boolean IsAvailable ( string client )
 	{
 	    //in the installed system, we don't care if the client isn't there
diff --git a/src/include/partitioning/ep-btrfs-dialogs.ycp b/src/include/partitioning/ep-btrfs-dialogs.ycp
index 8e99597..4923dea 100644
--- a/src/include/partitioning/ep-btrfs-dialogs.ycp
+++ b/src/include/partitioning/ep-btrfs-dialogs.ycp
@@ -30,6 +30,15 @@
 {
     textdomain "storage";
 
+    import "DevicesSelectionBox";
+    import "Greasemonkey";
+    import "MiniWorkflow";
+    import "Partitions";
+    import "Popup";
+    import "Storage";
+    import "StorageIcons";
+    import "StorageSettings";
+
 
     boolean DlgEditBtrfsVolume(map<string, any> &data)
 	{
diff --git a/src/include/partitioning/ep-btrfs-lib.ycp b/src/include/partitioning/ep-btrfs-lib.ycp
index 025a667..4753bd3 100644
--- a/src/include/partitioning/ep-btrfs-lib.ycp
+++ b/src/include/partitioning/ep-btrfs-lib.ycp
@@ -28,9 +28,14 @@
  * This file must only be included in other Expert Partitioner files ("ep-*.ycp").
  */
 {
+    import "Partitions";
+    import "Popup";
+    import "Storage";
+    import "TreePanel";
     textdomain "storage";
 
 
+
 void EpEditBtrfsDevice(string device)
     {
     if (device == nil)
diff --git a/src/include/partitioning/ep-dialogs.ycp b/src/include/partitioning/ep-dialogs.ycp
index 23f250d..642f555 100644
--- a/src/include/partitioning/ep-dialogs.ycp
+++ b/src/include/partitioning/ep-dialogs.ycp
@@ -30,6 +30,16 @@
 {
     textdomain "storage";
 
+    import "FileSystems";
+    import "HTML";
+    import "Integer";
+    import "Mode";
+    import "Partitions";
+    import "Popup";
+    import "Region";
+    import "Stage";
+    import "Storage";
+    import "StorageSettings";
 
     include "partitioning/ep-lib.ycp";
     include "partitioning/custom_part_lib.ycp";
@@ -724,8 +734,21 @@ because the filesystem seems to be inconsistent.
 	switch (data["type"]:`unknown)
 	{
 	    case `primary:
+        {
+                // no falldown in ruby
+		// Heading for dialog
+		heading = sformat(_("Resize Partition %1"), device);
+
+		cyl_size = disk["cyl_size"]:1;
+		integer free_cyl_before = 0;
+		Storage::FreeCylindersAroundPartition(device, free_cyl_before, free_cyl_after);
+
+		min_size_k = Integer::Max([ min_size_k, cyl_size / 1024 ]);
+		max_size_k = size_k + (cyl_size * free_cyl_after) / 1024;
+        }
+	    break;
 	    case `logical:
-	    {
+      {
 		// Heading for dialog
 		heading = sformat(_("Resize Partition %1"), device);
 
@@ -735,17 +758,17 @@ because the filesystem seems to be inconsistent.
 
 		min_size_k = Integer::Max([ min_size_k, cyl_size / 1024 ]);
 		max_size_k = size_k + (cyl_size * free_cyl_after) / 1024;
-	    }
+      }
 	    break;
 
 	    case `lvm:
-	    {
+      {
 		// Heading for dialog
 		heading = sformat(_("Resize Logical Volume %1"), device);
 
 		min_size_k = Integer::Max([ min_size_k, disk["pesize"]:0 / 1024 ]);
 		max_size_k = size_k + (disk["pe_free"]:0 * disk["pesize"]:0) / 1024;
-	    }
+      }
 	    break;
 	}
 
@@ -837,23 +860,17 @@ because the filesystem seems to be inconsistent.
 	        }
 
 	        case `ok:
-	        {
 		    switch ((symbol) UI::QueryWidget(`id(`size), `Value))
 		    {
 			case `max_size:
-			{
 			    size_k = max_size_k;
 			    break;
-			}
 
 			case `min_size:
-			{
 			    size_k = min_size_k;
 			    break;
-			}
 
 			case `custom_size:
-			{
 			    string tmp = (string) UI::QueryWidget(`id(`custom_size_input), `Value);
 			    if (!Storage::HumanStringToKByteWithRangeCheck(tmp, size_k, min_size_k, max_size_k))
 			    {
@@ -863,9 +880,8 @@ because the filesystem seems to be inconsistent.
 						     Storage::KByteToHumanString(max_size_k)));
 				widget = `again;
 				continue;
-			    }
-			    break;
 			}
+			    break;
 		    }
 
 		    if (size_k != old_size_k)
@@ -907,10 +923,19 @@ resize task a lot."), (size_k-old_size_k)/(1024*1024) );
 			switch (data["type"]:`unknown)
 			{
 			    case `primary:
+            {
+				integer num_cyl = tointeger(1024.0 * size_k / cyl_size + 0.5);
+				num_cyl = Integer::Clamp(num_cyl, 1, data["region", 1]:0 + free_cyl_after);
+				data["region", 1] = num_cyl;
+            }
+				break;
+
 			    case `logical:
+        {
 				integer num_cyl = tointeger(1024.0 * size_k / cyl_size + 0.5);
 				num_cyl = Integer::Clamp(num_cyl, 1, data["region", 1]:0 + free_cyl_after);
 				data["region", 1] = num_cyl;
+        }
 				break;
 
 			    case `lvm:
@@ -919,7 +944,6 @@ resize task a lot."), (size_k-old_size_k)/(1024*1024) );
 			}
 		    }
 		    break;
-	        }
 
 		case `cancel:
 		    break;
diff --git a/src/include/partitioning/ep-dm-dialogs.ycp b/src/include/partitioning/ep-dm-dialogs.ycp
index 5b930a9..98e5130 100644
--- a/src/include/partitioning/ep-dm-dialogs.ycp
+++ b/src/include/partitioning/ep-dm-dialogs.ycp
@@ -29,6 +29,7 @@
  */
 {
     textdomain "storage";
+    import "MiniWorkflow";
 
 
     boolean DlgEditDmVolume(map<string, any> &data)
diff --git a/src/include/partitioning/ep-graph.ycp b/src/include/partitioning/ep-graph.ycp
index a699521..8befd7d 100644
--- a/src/include/partitioning/ep-graph.ycp
+++ b/src/include/partitioning/ep-graph.ycp
@@ -98,7 +98,6 @@
 	switch (Event::IsWidgetContextMenuActivated(event))
 	{
 	    case `graph:
-	    {
 		string node = (string) UI::QueryWidget(`id(`graph), `Item);
 
 		if (isempty(node))
@@ -107,7 +106,6 @@
 		    EpContextMenuDevice(substring(node, 7));
 
 		// TODO: update graph
-	    }
 	    break;
 	}
 
@@ -190,16 +188,13 @@
 	switch (Event::IsWidgetActivated(event))
 	{
 	    case `graph:
-	    {
 		string node = (string) UI::QueryWidget(`id(`graph), `Item);
 
 		if (String::StartsWith(node, "mountpoint:"))
 		    GotoDevice(substring(node, 11));
-	    }
 	    break;
 
 	    case `save:
-	    {
 		string filename = UI::AskForSaveFileName("/tmp", "*.gv", "Save as...");
 		if (filename != nil)
 		{
@@ -209,7 +204,6 @@
 			Popup::Error(_("Saving graph file failed."));
 		    }
 		}
-	    }
 	    break;
 	}
     }
diff --git a/src/include/partitioning/ep-hd-dialogs.ycp b/src/include/partitioning/ep-hd-dialogs.ycp
index db85155..7d911fc 100644
--- a/src/include/partitioning/ep-hd-dialogs.ycp
+++ b/src/include/partitioning/ep-hd-dialogs.ycp
@@ -223,7 +223,6 @@
 		    switch (what)
 		    {
 			case `manual_size:
-			{
 			    string tmp = (string) UI::QueryWidget(`id(`size_input), `Value);
 			    if (!Storage::HumanStringToKByteWithRangeCheck(tmp, size_k, min_size_k, max_size_k))
 			    {
@@ -236,10 +235,8 @@
 				continue;
 			    }
 			    break;
-			}
 
 			case `manual_region:
-			{
 			    integer s = (integer) UI::QueryWidget(`id(`start_cyl), `Value);
 			    integer e = (integer) UI::QueryWidget(`id(`end_cyl), `Value);
 			    region = [ s, e - s + 1 ];
@@ -258,7 +255,6 @@
 			    }
 
 			    break;
-			}
 		    }
 
 		    break;
@@ -271,24 +267,18 @@
 	    switch ((symbol) UI::QueryWidget(`id(`size), `Value))
 	    {
 		case `max_size:
-		{
 		    data["region"] = slot;
 		    break;
-		}
 
 		case `manual_size:
-		{
 		    integer num_cyl = tointeger(1024.0 * size_k / cyl_size + 0.5);
 		    num_cyl = Integer::Clamp(num_cyl, min_num_cyl, max_num_cyl);
 		    data["region"] = [ slot[0]:0, num_cyl ];
 		    break;
-		}
 
 		case `manual_region:
-		{
 		    data["region"] = region;
 		    break;
-		}
 	    }
 
 	    data["size_k"] = Region::Length(data["region"]:[0, 0]) * cyl_size / 1024;
diff --git a/src/include/partitioning/ep-hd.ycp b/src/include/partitioning/ep-hd.ycp
index 8ff41d0..9d8681f 100644
--- a/src/include/partitioning/ep-hd.ycp
+++ b/src/include/partitioning/ep-hd.ycp
@@ -30,6 +30,15 @@
 {
     textdomain "storage";
 
+    import "ContextMenu";
+    import "Event";
+    import "Popup";
+    import "Storage";
+    import "StorageIcons";
+    import "StorageFields";
+    import "StorageSettings";
+    import "TreePanel";
+
     include "partitioning/ep-hd-dialogs.ycp";
     include "partitioning/ep-hd-lib.ycp";
 
@@ -306,22 +315,18 @@ selected hard disk.</p>");
 	switch (Event::IsWidgetActivated(event))
 	{
 	    case `smart:
-	    {
 		if (!DiskMaySupportSmart(disk_device))
 		    Popup::Error(_("SMART is not available for this disk."));
 		else
 		    DisplayCommandOutput(sformat("/usr/sbin/smartctl --health '%1'", disk_device));
 		break;
-	    }
 
 	    case `hdparm:
-	    {
 		if (!DiskMaySupportHdparm(disk_device))
 		    Popup::Error(_("hdparm is not available for this disk."));
 		else
 		    DisplayCommandOutput(sformat("/sbin/hdparm -aAgr '%1'", disk_device));
 		break;
-	    }
 	}
     }
 
diff --git a/src/include/partitioning/ep-lib.ycp b/src/include/partitioning/ep-lib.ycp
index ce52274..3a7942a 100644
--- a/src/include/partitioning/ep-lib.ycp
+++ b/src/include/partitioning/ep-lib.ycp
@@ -102,7 +102,7 @@
 	switch (used_by)
 	{
 	    case `UB_LVM:
-	    {
+        {
         	list<string> volumes = Storage::GetAffectedDevices( device );
 		return ( ConfirmRecursiveDelete( device, volumes,
 		    _("Confirm Deleting Partition Used by LVM"),
@@ -112,10 +112,10 @@ and its logical volumes will be deleted:
 "), used_by_device),
 		    sformat( _("Delete partition \"%1\" and volume group \"%2\" now?"), device, used_by_device)
 		    ));
+        }
 		break;
-	    }
 	    case `UB_MD:
-	    {
+    {
         	list<string> volumes = Storage::GetAffectedDevices( device );
 		return ( ConfirmRecursiveDelete( device, volumes,
 		    _("Confirm Deleting Partition Used by RAID"),
@@ -125,8 +125,9 @@ RAID device will be deleted:
 "), used_by_device),
 		    sformat( _("Delete partition \"%1\" and RAID \"%2\" now?"), device, used_by_device)
 		    ));
+    }
+                break;
 
-	    }
 	    default:
 		break;
 	}
diff --git a/src/include/partitioning/ep-loop-dialogs.ycp b/src/include/partitioning/ep-loop-dialogs.ycp
index 28e2dbf..6528e5f 100644
--- a/src/include/partitioning/ep-loop-dialogs.ycp
+++ b/src/include/partitioning/ep-loop-dialogs.ycp
@@ -30,6 +30,12 @@
 {
     textdomain "storage";
 
+    import "Mode";
+    import "MiniWorkflow";
+    import "Popup";
+    import "Storage";
+    import "StorageIcons";
+
 
     string MiniWorkflowStepLoopNameSizeHelptext()
     {
diff --git a/src/include/partitioning/ep-lvm-dialogs.ycp b/src/include/partitioning/ep-lvm-dialogs.ycp
index 79f774f..df2e250 100644
--- a/src/include/partitioning/ep-lvm-dialogs.ycp
+++ b/src/include/partitioning/ep-lvm-dialogs.ycp
@@ -693,7 +693,13 @@ This means the volume allocates needed space on demand from a <b>Thin Pool</b>.<
 	    switch (widget)
 	    {
 		case `pool:
+                    //no falldown in ruby
+		    UI::ChangeWidget(`id(`used_pool), `Enabled, (widget==`thin));
+		    break;
 		case `thin:
+                    //no falldown in ruby
+		    UI::ChangeWidget(`id(`used_pool), `Enabled, (widget==`thin));
+		    break;
 		case `normal:
 		    UI::ChangeWidget(`id(`used_pool), `Enabled, (widget==`thin));
 		    break;
diff --git a/src/include/partitioning/ep-lvm-lib.ycp b/src/include/partitioning/ep-lvm-lib.ycp
index e8a42d5..f870e04 100644
--- a/src/include/partitioning/ep-lvm-lib.ycp
+++ b/src/include/partitioning/ep-lvm-lib.ycp
@@ -28,6 +28,11 @@
  * This file must only be included in other Expert Partitioner files ("ep-*.ycp").
  */
 {
+
+   import "Partitions";
+   import "Popup";
+   import "Storage";
+   import "TreePanel";
     textdomain "storage";
 
 
diff --git a/src/include/partitioning/ep-lvm.ycp b/src/include/partitioning/ep-lvm.ycp
index f445e73..860e5db 100644
--- a/src/include/partitioning/ep-lvm.ycp
+++ b/src/include/partitioning/ep-lvm.ycp
@@ -33,6 +33,10 @@
     include "partitioning/ep-lvm-dialogs.ycp";
     include "partitioning/ep-lvm-lib.ycp";
 
+    import "ContextMenu";
+    import "Storage";
+    import "StorageIcons";
+
 
     void EpContextMenuLvmVg(string device)
     {
diff --git a/src/include/partitioning/ep-main.ycp b/src/include/partitioning/ep-main.ycp
index 0f685c6..68a877b 100644
--- a/src/include/partitioning/ep-main.ycp
+++ b/src/include/partitioning/ep-main.ycp
@@ -183,8 +183,20 @@
 	    switch(type)
 	    {
 		case `CT_DISK:
+        // no falldown in ruby
+		    huhu(disk, `hd, $[ `create : CreateHdPartitionPanel, `handle : HandleHdPartitionPanel ],
+			 $[ `create : CreateHdDiskPanel, `handle : HandleHdDiskPanel ]);
+		    break;
 		case `CT_DMRAID:
+        // no falldown in ruby
+		    huhu(disk, `hd, $[ `create : CreateHdPartitionPanel, `handle : HandleHdPartitionPanel ],
+			 $[ `create : CreateHdDiskPanel, `handle : HandleHdDiskPanel ]);
+		    break;
 		case `CT_DMMULTIPATH:
+        // no falldown in ruby
+		    huhu(disk, `hd, $[ `create : CreateHdPartitionPanel, `handle : HandleHdPartitionPanel ],
+			 $[ `create : CreateHdDiskPanel, `handle : HandleHdDiskPanel ]);
+		    break;
 		case `CT_MDPART:
 		    huhu(disk, `hd, $[ `create : CreateHdPartitionPanel, `handle : HandleHdPartitionPanel ],
 			 $[ `create : CreateHdDiskPanel, `handle : HandleHdDiskPanel ]);
@@ -288,8 +300,29 @@
 	switch (disk["type"]:`unknown)
 	{
 	    case `CT_DISK:  
+        // no falldown in ruby
+		if (part == nil)
+		    EpContextMenuHdDisk(device);
+		else
+		    EpContextMenuHdPartition(device);
+		break;
+
 	    case `CT_MDPART:
+        // no falldown in ruby
+		if (part == nil)
+		    EpContextMenuHdDisk(device);
+		else
+		    EpContextMenuHdPartition(device);
+		break;
+
 	    case `CT_DMRAID:
+        // no falldown in ruby
+		if (part == nil)
+		    EpContextMenuHdDisk(device);
+		else
+		    EpContextMenuHdPartition(device);
+		break;
+
 	    case `CT_DMMULTIPATH:
 		if (part == nil)
 		    EpContextMenuHdDisk(device);
@@ -463,16 +496,23 @@ Really exit?"), deletechars(label, "&"));
 
 	    switch (widget)
 	    {
-		case `back:
-		case `abort: {
+		case `back: 
+        // no falldown in ruby
 		    if (!Storage::EqualBackupStates("expert-partitioner", "", true))
 		    {
 			if (!ReallyQuit(widget == `back ? back_label : abort_label))
 			    widget = `again;
 		    }
-		} break;
+		 break;
+		case `abort:
+		    if (!Storage::EqualBackupStates("expert-partitioner", "", true))
+		    {
+			if (!ReallyQuit(widget == `back ? back_label : abort_label))
+			    widget = `again;
+		    }
+		 break;
 
-		case `next: {
+		case `next:
 		    if (!Storage::EqualBackupStates("expert-partitioner", "", true) || StorageSettings::GetModified())
 		    {
 		        if (!check_created_partition_table(Storage::GetTargetMap(),
@@ -494,16 +534,16 @@ Really exit?"), deletechars(label, "&"));
 			y2milestone("No changes to partitioning - nothing to do");
 			widget = `abort;
 		    }
-		} break;
+		break;
 	    }
 
 	    switch (Event::IsWidgetActivated(event))
 	    {
-		case `table: {
+		case `table:
 		    any citem = UI::QueryWidget(`id(`table), `CurrentItem);
 		    TreePanel::SwitchToNew(citem);
 		    UI::SetFocus( UI::WidgetExists(`id(`table)) ? `id(`table) : `id(`text));
-		} break;
+		break;
 	    }
 	}
 	until (widget == `back || widget == `abort || widget == `next);
@@ -513,6 +553,11 @@ Really exit?"), deletechars(label, "&"));
 	switch (widget)
 	{
 	    case `back:
+        // no falldown in ruby
+		if (Storage::GetPartMode() == "NORMAL")
+		    Storage::SetPartMode("CUSTOM");
+
+		break;
 	    case `abort:
 
 		if (Storage::GetPartMode() == "NORMAL")
diff --git a/src/include/partitioning/ep-nfs.ycp b/src/include/partitioning/ep-nfs.ycp
index d0c0d9b..2659e21 100644
--- a/src/include/partitioning/ep-nfs.ycp
+++ b/src/include/partitioning/ep-nfs.ycp
@@ -207,20 +207,14 @@
 	    switch (Event::IsWidgetActivated(event))
 	    {
 	        case `newbut:
-	        {
 		    AddShare( line );
 		    break;
-	        }
 	        case `editbut:
-	        {
 		    EditShare( line );
 		    break;
-	        }
 	        case `delbut:
-	        {
 		    DeleteShare( line );
 		    break;
-	        }
 	        default:
 		    break;
 	     }
diff --git a/src/include/partitioning/ep-raid-dialogs.ycp b/src/include/partitioning/ep-raid-dialogs.ycp
index bcc655c..0f2046c 100644
--- a/src/include/partitioning/ep-raid-dialogs.ycp
+++ b/src/include/partitioning/ep-raid-dialogs.ycp
@@ -28,6 +28,14 @@
  * This file must only be included in other Expert Partitioner files ("ep-*.ycp").
  */
 {
+    import "DevicesSelectionBox";
+    import "Greasemonkey";
+    import "Integer";
+    import "MiniWorkflow";
+    import "Popup";
+    import "Storage";
+    import "StorageIcons";
+    import "StorageSettings";
     textdomain "storage";
 
 
@@ -177,25 +185,38 @@ to get the redundancy and performance you want.</p>
 	    switch (widget)
 	    {
 		case `raid0:
+                    //no falldown in ruby
+		    raid_type = substring(tostring((symbol) UI::QueryWidget(`id(`raid_type), `Value)), 1);
+		    DevicesSelectionBox::UpdateSelectedSize();
+		break;
 		case `raid1:
+                    //no falldown in ruby
+		    raid_type = substring(tostring((symbol) UI::QueryWidget(`id(`raid_type), `Value)), 1);
+		    DevicesSelectionBox::UpdateSelectedSize();
+		break;
 		case `raid5:
+                    //no falldown in ruby
+		    raid_type = substring(tostring((symbol) UI::QueryWidget(`id(`raid_type), `Value)), 1);
+		    DevicesSelectionBox::UpdateSelectedSize();
+		break;
 		case `raid6:
+                    //no falldown in ruby
+		    raid_type = substring(tostring((symbol) UI::QueryWidget(`id(`raid_type), `Value)), 1);
+		    DevicesSelectionBox::UpdateSelectedSize();
+		break;
 		case `raid10:
-		{
+                    //no falldown in ruby
 		    raid_type = substring(tostring((symbol) UI::QueryWidget(`id(`raid_type), `Value)), 1);
 		    DevicesSelectionBox::UpdateSelectedSize();
-		}
 		break;
 
 		case `next:
-		{
 		    devices = maplist(map device, DevicesSelectionBox::GetSelectedDevices(), {
 			return device["device"]:"";
 		    });
 
 		    if (!CheckNumberOfDevicesForRaid(raid_type, size(devices)))
 			widget = `again;
-		}
 		break;
 	    }
 	}
@@ -367,14 +388,12 @@ algorithm please look at the man page for mdadm (man mdadm).
 	    switch (widget)
 	    {
 		case `next:
-		{
 		    devices_new = maplist(map device, DevicesSelectionBox::GetSelectedDevices(), {
 			return device["device"]:"";
 		    });
 
 		    if (!CheckNumberOfDevicesForRaid(raid_type, size(devices_new)))
 			widget = `again;
-		}
 		break;
 	    }
 	}
diff --git a/src/include/partitioning/ep-summary.ycp b/src/include/partitioning/ep-summary.ycp
index e6f8ad9..02de74b 100644
--- a/src/include/partitioning/ep-summary.ycp
+++ b/src/include/partitioning/ep-summary.ycp
@@ -30,6 +30,10 @@
 {
     textdomain "storage";
 
+    import "Greasemonkey";
+    import "StorageIcons";
+    import "Wizard";
+
 
     void CreateSummaryPanel(any user_data)
     {
diff --git a/src/include/partitioning/ep-unused.ycp b/src/include/partitioning/ep-unused.ycp
index 0ab4427..d7bb75e 100644
--- a/src/include/partitioning/ep-unused.ycp
+++ b/src/include/partitioning/ep-unused.ycp
@@ -30,6 +30,23 @@
 {
     textdomain "storage";
 
+    import "Event";
+    import "HTML";
+    import "Icon";
+    import "Integer";
+    import "Label";
+    import "MiniWorkflow";
+    import "Package";
+    import "Popup";
+    import "Stage";
+    import "Storage";
+    import "StorageFields";
+    import "StorageIcons";
+    import "StorageSettings";
+    import "String";
+    import "TreePanel";
+    import "Wizard";
+
     include "partitioning/ep-dialogs.ycp";
 
 
@@ -119,6 +136,7 @@ all current changes. Really rescan unused devices?")))
 		    UpdateNavigationTree(nil);
 		    TreePanel::Create();
 		}
+    break;
 	}
     }
 }
diff --git a/src/include/partitioning/partition_defines.ycp b/src/include/partitioning/partition_defines.ycp
index 7c7759d..251218b 100644
--- a/src/include/partitioning/partition_defines.ycp
+++ b/src/include/partitioning/partition_defines.ycp
@@ -40,6 +40,7 @@
 {
   import "Mode";
   import "FileSystems";
+  import "Storage";
 
   textdomain "storage";
 
diff --git a/src/modules/DualMultiSelectionBox.ycp b/src/modules/DualMultiSelectionBox.ycp
index 17c9c81..713b58c 100644
--- a/src/modules/DualMultiSelectionBox.ycp
+++ b/src/modules/DualMultiSelectionBox.ycp
@@ -456,15 +456,31 @@ list<string> reverse( list<string> v )
         list<string> sel = [];
 	switch (widget)
 	{
-	    case `unselected:
+	    case `unselected: {
+    // no fall thrue
+		list<any> tmp1 = (list<any>) UI::QueryWidget(`id(`unselected), `SelectedItems);
+		selected = flatten([ selected, tmp1 ]);
+		sel = (list<string>) UI::QueryWidget(`id(`selected), `SelectedItems);
+                y2milestone( "selected:%1", selected );
+	    } break;
+
 	    case `add: {
+    // no fall thrue
 		list<any> tmp1 = (list<any>) UI::QueryWidget(`id(`unselected), `SelectedItems);
 		selected = flatten([ selected, tmp1 ]);
 		sel = (list<string>) UI::QueryWidget(`id(`selected), `SelectedItems);
                 y2milestone( "selected:%1", selected );
 	    } break;
 
-	    case `selected:
+	    case `selected: {
+    // no fall thrue
+list<any> tmp1 = (list<any>) UI::QueryWidget(`id(`selected), `SelectedItems);
+		selected = filter(any tmp2, selected, { return !contains(tmp1, tmp2); });
+		sel = (list<string>) UI::QueryWidget(`id(`selected), `SelectedItems);
+                sel = (list<string>)filter(any tmp2, sel, { return !contains(tmp1, tmp2); });
+                y2milestone( "selected:%1", selected );
+	    } break;
+
 	    case `remove: {
 		list<any> tmp1 = (list<any>) UI::QueryWidget(`id(`selected), `SelectedItems);
 		selected = filter(any tmp2, selected, { return !contains(tmp1, tmp2); });
@@ -500,7 +516,32 @@ list<string> reverse( list<string> v )
 
 	    } break;
 
-	    case `up:
+	    case `up: {
+    // no fall thrue
+                boolean up = (widget==`up);
+		sel = (list<string>) UI::QueryWidget(`id(`selected), `SelectedItems);
+                integer cnt = -1;
+                integer siz = size(selected)-1;
+                map<string,integer> sm = 
+                    listmap( string s, 
+                             (list<string>)selected, 
+                             { cnt=cnt+1; return( $[ s : cnt ] ); } );
+                cnt = 0;
+                integer diff = up ? -1 : 1;
+                if( !up )
+                    sel = reverse(sel);
+                foreach( string s, sel,
+                    {
+                    integer idx = sm[s]:0;
+                    if( (up && idx>cnt) || (!up && idx<siz-cnt) )
+                        {
+                        selected = list::swap( selected, idx+diff, idx );
+                        }
+                    cnt=cnt+1;
+                    });
+                y2milestone( "change:%1 selected:%2", sel, selected  );
+	    } break;
+
 	    case `down: {
                 boolean up = (widget==`up);
 		sel = (list<string>) UI::QueryWidget(`id(`selected), `SelectedItems);
@@ -526,7 +567,17 @@ list<string> reverse( list<string> v )
                 y2milestone( "change:%1 selected:%2", sel, selected  );
 	    } break;
 
-	    case `top:
+	    case `top: {
+    // no fall thrue
+                boolean up = (widget==`top);
+		sel = (list<string>) UI::QueryWidget(`id(`selected), `SelectedItems);
+                selected = filter( string s, (list<string>)selected, ``(!contains( sel, s )));
+                if( up )
+                    selected = merge( sel, selected );
+                else
+                    selected = merge( selected, sel );
+                y2milestone( "change:%1 selected:%2", sel, selected  );
+	    } break;
 	    case `bottom: {
                 boolean up = (widget==`top);
 		sel = (list<string>) UI::QueryWidget(`id(`selected), `SelectedItems);
diff --git a/src/modules/Partitions.ycp b/src/modules/Partitions.ycp
index 129e77f..36bc9b4 100644
--- a/src/modules/Partitions.ycp
+++ b/src/modules/Partitions.ycp
@@ -664,99 +664,99 @@ global string FsIdToString(integer fs_id)
 {
     switch (fs_id)
     {
-	case 0x0: return "empty";
-	case 0x1: return "FAT12";
-	case 0x2: return "XENIX root";
-	case 0x3: return "XENIX usr";
-	case 0x4: return "FAT16 <32M";
-	case 0x5: return "Extended";
-	case 0x6: return "FAT16";
-	case 0x7: return "HPFS/NTFS";
-	case 0x8: return "AIX";
-	case 0x9: return "AIX boot";
-	case 0xa: return "OS/2 boot manager";
-	case 0xb: return "Win95 FAT32";
-	case 0xc: return "Win95 FAT32 LBA";
-	case 0xe: return "Win95 FAT16";
-	case 0xf: return "Extended";
-	case 0xa7: return "NeXTSTEP";
-	case 0xb7: return "BSDI fs";
-	case 0xb8: return "BSDI swap";
-	case 0xc1: return "DRDOS/sec";
-	case 0xc4: return "DRDOS/sec";
-	case 0xc6: return "DRDOS/sec";
-	case 0xc7: return "Syrinx";
-	case 0xda: return "Non-Fs data";
-	case 0xdb: return "CP/M / CTOS";
-	case 0xde: return "Dell Utility";
-	case 0xe1: return "DOS access";
-	case 0xe3: return "DOS R/O";
-	case 0xe4: return "SpeedStor";
-	case 0xeb: return "BeOS fs";
-	case 0xee: return "EFI GPT";
-	case 0xef: return "EFI (FAT-12/16)";
-	case 0xf1: return "SpeedStor";
-	case 0xf4: return "SpeedStor";
-	case 0xf2: return "DOS secondary";
-	case 0xfd: return "Linux RAID";
-	case 0xfe: return "LANstep";
-	case 0xff: return "BBT or NBO reserved";
-	case 0x10: return "OPUS";
-	case 0x11: return "Hidden FAT12";
-	case 0x12: return "Vendor diag";
-	case 0x14: return "Hidden FAT16";
-	case 0x16: return "Hidden FAT16";
-	case 0x17: return "Hidden HPFS/NTFS";
-	case 0x18: return "AST Windows";
-	case 0x1b: return "Hidden Win95";
-	case 0x1c: return "Hidden Win95";
-	case 0x1e: return "Hidden Win95";
-	case 0x24: return "NEC DOS";
-	case 0x39: return "Plan 9";
-	case 0x3c: return "PartitionMagic";
-	case 0x40: return "Venix 80286";
-	case 0x41: return "PPC PReP Boot";
-	case 0x42: return "SFS";
-	case 0x4d: return "QNX4.x";
-	case 0x4e: return "QNX4.x 2nd par";
-	case 0x4f: return "QNX4.x 3rd par";
-	case 0x50: return "OnTrack DM";
-	case 0x51: return "OnTrack DM6";
-	case 0x52: return "CP/M";
-	case 0x53: return "OnTrack DM6";
-	case 0x54: return "OnTrack DM6";
-	case 0x55: return "EZ-Drive";
-	case 0x56: return "Golden Bow";
-	case 0x5c: return "Priam Edisk";
-	case 0x61: return "SpeedStor";
-	case 0x63: return "GNU HURD";
-	case 0x64: return "Novell NetWare";
-	case 0x65: return "Novell NetWare";
-	case 0x70: return "DiskSecure";
-	case 0x75: return "PC/IX";
-	case 0x80: return "Old Minix";
-	case 0x81: return "Minix";
-	case 0x82: return "Linux swap";
-	case 0x83: return "Linux native";
-	case 0x84: return "OS/2 hidden";
-	case 0x85: return "Linux extended";
-	case 0x86: return "NTFS volume";
-	case 0x87: return "NTFS volume";
-	case 0x8e: return "Linux LVM";
-	case 0x93: return "Amoeba";
-	case 0x94: return "Amoeba BBT";
-	case 0x9f: return "BSD/OS";
-	case 0xa0: return "Hibernation";
-	case 0xa5: return "FreeBSD";
-	case 0xa6: return "OpenBSD";
-	case 0xa9: return "NetBSD";
-	case 0x102: return "Apple_HFS";
-	case 0x103: return "EFI boot";
-	case 0x104: return "Service";
-	case 0x105: return "Microsoft reserved";
-	case 0x106: return "Apple_UFS";
-	case 0x107: return "BIOS Grub";
-	default: return "unknown";
+	case 0x0: return "empty"; break;
+	case 0x1: return "FAT12"; break;
+	case 0x2: return "XENIX root"; break;
+	case 0x3: return "XENIX usr"; break;
+	case 0x4: return "FAT16 <32M"; break;
+	case 0x5: return "Extended"; break;
+	case 0x6: return "FAT16"; break;
+	case 0x7: return "HPFS/NTFS"; break;
+	case 0x8: return "AIX"; break;
+	case 0x9: return "AIX boot"; break;
+	case 0xa: return "OS/2 boot manager"; break;
+	case 0xb: return "Win95 FAT32"; break;
+	case 0xc: return "Win95 FAT32 LBA"; break;
+	case 0xe: return "Win95 FAT16"; break;
+	case 0xf: return "Extended"; break;
+	case 0xa7: return "NeXTSTEP"; break;
+	case 0xb7: return "BSDI fs"; break;
+	case 0xb8: return "BSDI swap"; break;
+	case 0xc1: return "DRDOS/sec"; break;
+	case 0xc4: return "DRDOS/sec"; break;
+	case 0xc6: return "DRDOS/sec"; break;
+	case 0xc7: return "Syrinx"; break;
+	case 0xda: return "Non-Fs data"; break;
+	case 0xdb: return "CP/M / CTOS"; break;
+	case 0xde: return "Dell Utility"; break;
+	case 0xe1: return "DOS access"; break;
+	case 0xe3: return "DOS R/O"; break;
+	case 0xe4: return "SpeedStor"; break;
+	case 0xeb: return "BeOS fs"; break;
+	case 0xee: return "EFI GPT"; break;
+	case 0xef: return "EFI (FAT-12/16)"; break;
+	case 0xf1: return "SpeedStor"; break;
+	case 0xf4: return "SpeedStor"; break;
+	case 0xf2: return "DOS secondary"; break;
+	case 0xfd: return "Linux RAID"; break;
+	case 0xfe: return "LANstep"; break;
+	case 0xff: return "BBT or NBO reserved"; break;
+	case 0x10: return "OPUS"; break;
+	case 0x11: return "Hidden FAT12"; break;
+	case 0x12: return "Vendor diag"; break;
+	case 0x14: return "Hidden FAT16"; break;
+	case 0x16: return "Hidden FAT16"; break;
+	case 0x17: return "Hidden HPFS/NTFS"; break;
+	case 0x18: return "AST Windows"; break;
+	case 0x1b: return "Hidden Win95"; break;
+	case 0x1c: return "Hidden Win95"; break;
+	case 0x1e: return "Hidden Win95"; break;
+	case 0x24: return "NEC DOS"; break;
+	case 0x39: return "Plan 9"; break;
+	case 0x3c: return "PartitionMagic"; break;
+	case 0x40: return "Venix 80286"; break;
+	case 0x41: return "PPC PReP Boot"; break;
+	case 0x42: return "SFS"; break;
+	case 0x4d: return "QNX4.x"; break;
+	case 0x4e: return "QNX4.x 2nd par"; break;
+	case 0x4f: return "QNX4.x 3rd par"; break;
+	case 0x50: return "OnTrack DM"; break;
+	case 0x51: return "OnTrack DM6"; break;
+	case 0x52: return "CP/M"; break;
+	case 0x53: return "OnTrack DM6"; break;
+	case 0x54: return "OnTrack DM6"; break;
+	case 0x55: return "EZ-Drive"; break;
+	case 0x56: return "Golden Bow"; break;
+	case 0x5c: return "Priam Edisk"; break;
+	case 0x61: return "SpeedStor"; break;
+	case 0x63: return "GNU HURD"; break;
+	case 0x64: return "Novell NetWare"; break;
+	case 0x65: return "Novell NetWare"; break;
+	case 0x70: return "DiskSecure"; break;
+	case 0x75: return "PC/IX"; break;
+	case 0x80: return "Old Minix"; break;
+	case 0x81: return "Minix"; break;
+	case 0x82: return "Linux swap"; break;
+	case 0x83: return "Linux native"; break;
+	case 0x84: return "OS/2 hidden"; break;
+	case 0x85: return "Linux extended"; break;
+	case 0x86: return "NTFS volume"; break;
+	case 0x87: return "NTFS volume"; break;
+	case 0x8e: return "Linux LVM"; break;
+	case 0x93: return "Amoeba"; break;
+	case 0x94: return "Amoeba BBT"; break;
+	case 0x9f: return "BSD/OS"; break;
+	case 0xa0: return "Hibernation"; break;
+	case 0xa5: return "FreeBSD"; break;
+	case 0xa6: return "OpenBSD"; break;
+	case 0xa9: return "NetBSD"; break;
+	case 0x102: return "Apple_HFS"; break;
+	case 0x103: return "EFI boot"; break;
+	case 0x104: return "Service"; break;
+	case 0x105: return "Microsoft reserved"; break;
+	case 0x106: return "Apple_UFS"; break;
+	case 0x107: return "BIOS Grub"; break;
+	default: return "unknown"; break;
     }
 }
 
diff --git a/src/modules/Storage.ycp b/src/modules/Storage.ycp
index 0ea15c5..81c882e 100644
--- a/src/modules/Storage.ycp
+++ b/src/modules/Storage.ycp
@@ -29,16 +29,16 @@
  * to * access and modify the partitioning settings.
  *
  * Todo: Translate
- * Diese Modul enth‰lt alle Informationen die f¸r die Partitionierung der
+ * Diese Modul enth√§lt alle Informationen die f√ºr die Partitionierung der
  * Festplatten erforderlich sind. Diese Informationen bestehen aus der
  * Beschreibung, der vor der Partitionierung vorhandenen Platteneinstellungen,
- * und der Art und Weise wie diese ver‰ndert werden soll.
- * Alle nˆtigen Zugriffsfunktionen auf diese Datenstruktur sind ebenfalls in
+ * und der Art und Weise wie diese ver√§ndert werden soll.
+ * Alle n√∂tigen Zugriffsfunktionen auf diese Datenstruktur sind ebenfalls in
  * diesem Modul enthalten. Der Zugriff auf die Speicherung der
- * Partitionseinstellungen l‰uft also nur ¸ber dieses Modul.
- * Der Zugriff und die R¸ckgabe von Teilen der Partitionsdatenstruktur
+ * Partitionseinstellungen l√§uft also nur √ºber dieses Modul.
+ * Der Zugriff und die R√ºckgabe von Teilen der Partitionsdatenstruktur
  * wurde versucht "intelligent" zu gestallten und ist im einzelen bei den
- * entspechenden Funktionen n‰her erkl‰rt.
+ * entspechenden Funktionen n√§her erkl√§rt.
  *
  * $Id$
  */
diff --git a/src/modules/StorageFields.ycp b/src/modules/StorageFields.ycp
index 5aca433..f240311 100644
--- a/src/modules/StorageFields.ycp
+++ b/src/modules/StorageFields.ycp
@@ -86,20 +86,21 @@ global string UsedByString(map<string, any> used_by)
 	switch (type)
 	{
 	    case `UB_LVM:
-		return "LVM " + device;
+		return "LVM " + device; break;
 	    case `UB_DM:
-		return "DM " + device;
+		return "DM " + device; break;
 	    case `UB_DMRAID:
-		return "DM RAID " + device;
+		return "DM RAID " + device; break;
 	    case `UB_DMMULTIPATH:
-		return "DM Multipath " + device;
+		return "DM Multipath " + device; break;
 	    case `UB_MD:
+		return "MD RAID " + device; break;
 	    case `UB_MDPART:
-		return "MD RAID " + device;
+		return "MD RAID " + device; break;
 	    case `UB_BTRFS:
-		return "BTRFS " + device;
+		return "BTRFS " + device; break;
 	    default:
-		return device;
+		return device; break;
 	}
     }
 
@@ -516,6 +517,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by device name
 		    return sformat(_("Device: %1"), String::EscapeTags(value));
 	    }
+                break;
 
 	    case `size:
 	    {
@@ -526,6 +528,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by size
 		    return sformat(_("Size: %1"), value);
 	    }
+                break;
 
 	    case `type:
 	    {
@@ -581,6 +584,7 @@ Identifier of the file system.");
 		    // row label
 		    return sformat(_("Type: %1"), String::EscapeTags(value));
 	    }
+                break;
 
 	    case `format:
 	    {
@@ -598,6 +602,7 @@ Identifier of the file system.");
 		    // row label
 		    return sformat(_("Format: %1"), value);
 	    }
+                break;
 
 	    case `encrypted:
 	    {
@@ -620,6 +625,7 @@ Identifier of the file system.");
 		    return sformat(_("Encrypted: %1"), BooleanToHumanString(value));
 		}
 	    }
+                break;
 
 	    case `fs_type:
 	    {
@@ -630,6 +636,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by file system name e.g. "Ext3"
 		    return sformat(_("File System: %1"), value);
 	    }
+                break;
 
 	    case `mount_point:
 	    {
@@ -647,6 +654,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by mount point e.g. "/mnt"
 		    return sformat(_("Mount Point: %1"), String::EscapeTags(value));
 	    }
+                break;
 
 	    case `mount_by:
 	    {
@@ -671,6 +679,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by mount by method
 		    return sformat(_("Mount by: %1"), value);
 	    }
+                break;
 
 	    case `used_by:
 	    {
@@ -685,6 +694,7 @@ Identifier of the file system.");
 		    }), HTML::Newline());
 		}
 	    }
+                break;
 
 	    case `uuid:
 	    {
@@ -695,6 +705,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by file system uuid
 		    return sformat(_("UUID: %1"), value);
 	    }
+                break;
 
 	    case `label:
 	    {
@@ -705,6 +716,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by file system label
 		    return sformat(_("Label: %1"), String::EscapeTags(value));
 	    }
+                break;
 
 	    case `udev_path:
 	    {
@@ -715,6 +727,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by udev device path
 		    return sformat(_("Device Path: %1"), value);
 	    }
+                break;
 
 	    case `udev_id:
 	    {
@@ -728,6 +741,7 @@ Identifier of the file system.");
 		    }), HTML::Newline());
 		}
 	    }
+                break;
 
 	    case `bios_id:
 	    {
@@ -738,6 +752,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by bios id
 		    return sformat(_("BIOS ID: %1"), value);
 	    }
+                break;
 
 	    case `disk_label:
 	    {
@@ -748,6 +763,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by disk label e.g. "MSDOS" or "GPT"
 		    return sformat(_("Disk Label: %1"), value);
 	    }
+                break;
 
 	    case `vendor:
 	    {
@@ -758,6 +774,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by vendor name
 		    return sformat(_("Vendor: %1"), String::EscapeTags(value));
 	    }
+                break;
 
 	    case `model:
 	    {
@@ -768,6 +785,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by model string
 		    return sformat(_("Model: %1"), String::EscapeTags(value));
 	    }
+                break;
 
 	    case `bus:
 	    {
@@ -782,6 +800,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by bus name e.g. "SCSI"
 		    return sformat(_("Bus: %1"), value);
 	    }
+                break;
 
 	    case `lvm_metadata:
 	    {
@@ -794,6 +813,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by metadata version string
 		    return sformat(_("Metadata: %1"), value);
 	    }
+                break;
 
 	    case `pe_size:
 	    {
@@ -806,6 +826,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by size
 		    return sformat(_("PE Size: %1"), value);
 	    }
+                break;
 
 	    case `stripes:
 	    {
@@ -825,6 +846,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by integer
 		    return sformat(_("Stripes: %1"), value);
 	    }
+                break;
 
 	    case `raid_version:
 	    {
@@ -835,6 +857,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by raid version e.g. "1.00"
 		    return sformat(_("RAID Version: %1"), value);
 	    }
+                break;
 
 	    case `raid_type:
 	    {
@@ -845,6 +868,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by raid type e.g. "RAID1"
 		    return sformat(_("RAID Type: %1"), value);
 	    }
+                break;
 
 	    case `chunk_size:
 	    {
@@ -860,6 +884,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by size
 		    return sformat(_("Chunk Size: %1"), value);
 	    }
+                break;
 
 	    case `parity_algorithm:
 	    {
@@ -874,6 +899,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by algorithm name
 		    return sformat(_("Parity Algorithm: %1"), value);
 	    }
+                break;
 
 	    case `num_cyl:
 	    {
@@ -886,6 +912,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by integer
 		    return sformat(_("Number of Cylinders: %1"), value);
 	    }
+                break;
 
 	    case `cyl_size:
 	    {
@@ -898,6 +925,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by size
 		    return sformat(_("Cylinder Size: %1"), value);
 	    }
+                break;
 
 	    case `start_cyl:
 	    {
@@ -914,6 +942,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by integer
 		    return sformat(_("Start Cylinder: %1"), value);
 	    }
+                break;
 
 	    case `end_cyl:
 	    {
@@ -930,6 +959,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by integer
 		    return sformat(_("End Cylinder: %1"), value);
 	    }
+                break;
 
 	    case `sector_size:
 	    {
@@ -942,6 +972,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by size
 		    return sformat(_("Sector Size: %1"), value);
 	    }
+                break;
 
 	    case `fs_id:
 	    {
@@ -953,6 +984,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by file system id
 		    return sformat(_("FS ID: %1"), value);
 	    }
+                break;
 
 	    case `file_path:
 	    {
@@ -963,6 +995,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by file path e.g. "/data/secret"
 		    return sformat(_("File Path: %1"), String::EscapeTags(value));
 	    }
+                break;
 
 	    case `fc_wwpn:
 	    {
@@ -975,6 +1008,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by wwpn
 		    return sformat(_("WWPN: %1"), value);
 	    }
+                break;
 
 	    case `fc_fcp_lun:
 	    {
@@ -987,6 +1021,7 @@ Identifier of the file system.");
 		    // row label, %1 is replace by lun
 		    return sformat(_("LUN: %1"), value);
 	    }
+                break;
 
 	    case `fc_port_id:
 	    {
@@ -999,12 +1034,14 @@ Identifier of the file system.");
 		    // row label, %1 is replace by port id
 		    return sformat(_("Port ID: %1"), value);
 	    }
+                break;
 
 	    default:
 	    {
 		y2error("unknown field %1", field);
 		return "error";
 	    }
+                break;
 	}
     }
 
@@ -1318,25 +1355,25 @@ Identifier of the file system.");
 	    switch (field) {
 		case `heading_device:
 		    // heading
-		    return _("Device:");
+		    return _("Device:"); break;
 		case `heading_filesystem:
 		    // heading
-		    return _("File System:");
+		    return _("File System:"); break;
 		case `heading_hd:
 		    // heading
-		    return _("Hard Disk:");
+		    return _("Hard Disk:"); break;
 		case `heading_fc:
 		    // heading
-		    return _("Fibre Channel:");
+		    return _("Fibre Channel:"); break;
 		case `heading_lvm:
 		    // heading
-		    return _("LVM:");
+		    return _("LVM:"); break;
 		case `heading_md:
 		    // heading
-		    return _("RAID:");
+		    return _("RAID:"); break;
 		default:
 		    y2error("unknown field %1", field);
-		    return "error";
+		    return "error"; break;
 	    }
 	}
 
diff --git a/src/modules/StorageIcons.ycp b/src/modules/StorageIcons.ycp
index f52706f..968ac05 100644
--- a/src/modules/StorageIcons.ycp
+++ b/src/modules/StorageIcons.ycp
@@ -69,36 +69,45 @@
 	    case `CT_MDPART:
 	    case `sw_raid:
 		return raid_icon;
+    break;
 
 	    case `CT_DMMULTIPATH:
 	    case `CT_DM:
 	    case `dm:
 		return dm_icon;
+    break;
 
 	    case `CT_DISK:
 		return hd_icon;
+    break;
 
 	    case `CT_LOOP:
 	    case `loop:
 		return loop_icon;
+    break;
 
 	    case `CT_LVM:
 		return lvm_icon;
+    break;
 
 	    case `lvm:
 		return lvm_lv_icon;
+    break;
 
 	    case `CT_NFS:
 	    case `nfs:
 		return nfs_icon;
+    break;
 
 	    case `primary:
 	    case `logical:
 	    case `extended:
 		return hd_part_icon;
+    break;
 
 	    default:
 		return "yast-hdd-controller-kernel-module.png";
+    break;
 	}
     }
 
diff --git a/storage/Makefile.am b/storage/Makefile.am
deleted file mode 100644
index 3e4cfac..0000000
--- a/storage/Makefile.am
+++ /dev/null
@@ -1,5 +0,0 @@
-#
-# Makefile.am for storage/storage
-#
-
-SUBDIRS = data doc src
diff --git a/storage/src/Makefile.am b/storage/src/Makefile.am
deleted file mode 100644
index 3720ffa..0000000
--- a/storage/src/Makefile.am
+++ /dev/null
@@ -1,25 +0,0 @@
-#
-# Makefile.am for storage/storage/src
-#
-
-SUBDIRS = include modules proposal testsuite
-
-client_DATA =				\
-	inst_custom_part.ycp		\
-	inst_disk.ycp			\
-	inst_disk_proposal.ycp		\
-	inst_prepdisk.ycp		\
-	inst_resize_ui.ycp		\
-	inst_resize_dialog.ycp		\
-	inst_target_part.ycp		\
-	inst_target_selection.ycp	\
-	storage_finish.ycp
-
-EXTRA_DIST = $(client_DATA)
-
-partitioning:
-	ln -s include partitioning
-
-ycpchook = partitioning
-
-include $(top_srcdir)/Makefile.am.common
diff --git a/storage/src/include/Makefile.am b/storage/src/include/Makefile.am
deleted file mode 100644
index e2a0123..0000000
--- a/storage/src/include/Makefile.am
+++ /dev/null
@@ -1,9 +0,0 @@
-#
-# Makefile.am for storage/storage/src/include
-#
-
-yncludedir = @yncludedir@/partitioning
-
-ynclude_HEADERS = $(wildcard *.ycp)
-
-EXTRA_DIST = $(ynclude_HEADERS)
diff --git a/storage/src/modules/Makefile.am b/storage/src/modules/Makefile.am
deleted file mode 100644
index eae6439..0000000
--- a/storage/src/modules/Makefile.am
+++ /dev/null
@@ -1,33 +0,0 @@
-#
-# Makefile.am for storage/storage/src/modules
-#
-
-YCPCFLAGS = -M $(top_builddir)/bindings/ycp
-
-YCPC_LD_LIBRARY_PATH = $(top_builddir)/bindings/src/.libs
-YCPC_Y2DIR = $(top_builddir)/bindings/src/.libs
-
-module_DATA =				\
-	StorageInit.ycp      		\
-	Partitions.ycp			\
-	FileSystems.ycp			\
-	Storage.ycp			\
-	StorageClients.ycp      	\
-	StorageControllers.ycp  	\
-	StorageDevices.ycp		\
-	StorageFields.ycp		\
-	StorageIcons.ycp		\
-	StorageProposal.ycp		\
-	StorageSettings.ycp		\
-	StorageUpdate.ycp		\
-	TreePanel.ycp			\
-	TabPanel.ycp			\
-	MiniWorkflow.ycp		\
-	Greasemonkey.ycp		\
-	DevicesSelectionBox.ycp		\
-	DualMultiSelectionBox.ycp	\
-	Region.ycp
-
-EXTRA_DIST = $(module_DATA)
-
-include $(top_srcdir)/Makefile.am.common
diff --git a/storage/src/proposal/Makefile.am b/storage/src/proposal/Makefile.am
deleted file mode 100644
index 2659b2f..0000000
--- a/storage/src/proposal/Makefile.am
+++ /dev/null
@@ -1,8 +0,0 @@
-#
-# Makefile.am for storage/storage/src/proposal
-#
-
-client_DATA = partitions_proposal.ycp
-EXTRA_DIST = $(client_DATA)
-
-include $(top_srcdir)/Makefile.am.common
diff --git a/testsuite/tests/empty-efi1.ycp b/testsuite/tests/empty-efi1.ycp
index 4c5345d..ad1d0ee 100644
--- a/testsuite/tests/empty-efi1.ycp
+++ b/testsuite/tests/empty-efi1.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("empty-efi");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -13,5 +13,5 @@
     ProductFeatures::SetStringFeature("partitioning", "vm_desired_size", "30 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "20 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/empty-efi2.ycp b/testsuite/tests/empty-efi2.ycp
index 92de13a..3acd4f2 100644
--- a/testsuite/tests/empty-efi2.ycp
+++ b/testsuite/tests/empty-efi2.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("empty-efi");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -13,5 +13,5 @@
     ProductFeatures::SetStringFeature("partitioning", "vm_desired_size", "30 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "20 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/empty1.ycp b/testsuite/tests/empty1.ycp
index 827e006..915cd3c 100644
--- a/testsuite/tests/empty1.ycp
+++ b/testsuite/tests/empty1.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("empty");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -13,5 +13,5 @@
     ProductFeatures::SetStringFeature("partitioning", "vm_desired_size", "30 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "20 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/empty2.ycp b/testsuite/tests/empty2.ycp
index c688058..b6e23a5 100644
--- a/testsuite/tests/empty2.ycp
+++ b/testsuite/tests/empty2.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("empty");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -13,5 +13,5 @@
     ProductFeatures::SetStringFeature("partitioning", "vm_desired_size", "30 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "20 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/empty3.ycp b/testsuite/tests/empty3.ycp
index ca57fd0..46ad816 100644
--- a/testsuite/tests/empty3.ycp
+++ b/testsuite/tests/empty3.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("empty");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -14,5 +14,5 @@
     ProductFeatures::SetStringFeature("partitioning", "vm_desired_size", "30 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "20 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/empty4.ycp b/testsuite/tests/empty4.ycp
index 2943925..c4eb640 100644
--- a/testsuite/tests/empty4.ycp
+++ b/testsuite/tests/empty4.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("empty");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -14,5 +14,5 @@
     ProductFeatures::SetStringFeature("partitioning", "vm_desired_size", "30 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "20 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/empty5.ycp b/testsuite/tests/empty5.ycp
index 96e11c1..e88faf0 100644
--- a/testsuite/tests/empty5.ycp
+++ b/testsuite/tests/empty5.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("empty");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -13,5 +13,5 @@
     ProductFeatures::SetStringFeature("partitioning", "vm_desired_size", "30 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "20 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/empty6.ycp b/testsuite/tests/empty6.ycp
index 53d2154..0046892 100644
--- a/testsuite/tests/empty6.ycp
+++ b/testsuite/tests/empty6.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("empty");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -13,5 +13,5 @@
     ProductFeatures::SetStringFeature("partitioning", "vm_desired_size", "30 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "20 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/half-empty1.ycp b/testsuite/tests/half-empty1.ycp
index 2bbcf02..4af256b 100644
--- a/testsuite/tests/half-empty1.ycp
+++ b/testsuite/tests/half-empty1.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("half-empty");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -12,5 +12,5 @@
     ProductFeatures::SetBooleanFeature("partitioning", "proposal_lvm", false);
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "20 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/helper1b.yh b/testsuite/tests/helper1b.yh
index 969f8c6..e42852b 100644
--- a/testsuite/tests/helper1b.yh
+++ b/testsuite/tests/helper1b.yh
@@ -1,6 +1,7 @@
 {
     import "Storage";
     import "StorageProposal";
+    import "Testsuite";
 
     Storage::InitLibstorage(false);
 
diff --git a/testsuite/tests/reuse-home1.ycp b/testsuite/tests/reuse-home1.ycp
index 481de09..7622a00 100644
--- a/testsuite/tests/reuse-home1.ycp
+++ b/testsuite/tests/reuse-home1.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("reuse-home");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -13,5 +13,5 @@
     ProductFeatures::SetStringFeature("partitioning", "root_max_size", "20 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "15 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/windows-only-efi1.ycp b/testsuite/tests/windows-only-efi1.ycp
index d222d91..24093a5 100644
--- a/testsuite/tests/windows-only-efi1.ycp
+++ b/testsuite/tests/windows-only-efi1.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("windows-only-efi");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -13,5 +13,5 @@
     ProductFeatures::SetStringFeature("partitioning", "root_max_size", "20 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "15 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/windows-only1.ycp b/testsuite/tests/windows-only1.ycp
index 1ef97a5..06cf6a3 100644
--- a/testsuite/tests/windows-only1.ycp
+++ b/testsuite/tests/windows-only1.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("windows-only");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -13,5 +13,5 @@
     ProductFeatures::SetStringFeature("partitioning", "root_max_size", "20 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "15 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/testsuite/tests/windows1.ycp b/testsuite/tests/windows1.ycp
index 39df374..c751218 100644
--- a/testsuite/tests/windows1.ycp
+++ b/testsuite/tests/windows1.ycp
@@ -1,10 +1,10 @@
 // testedfiles: helper1b.yh
 {
-    include "./tests/setup-system.yh";
+    include "setup-system.yh";
 
     setup_system("windows");
 
-    include "./tests/helper1a.yh";
+    include "helper1a.yh";
 
     import "ProductFeatures";
 
@@ -13,5 +13,5 @@
     ProductFeatures::SetStringFeature("partitioning", "root_max_size", "20 GB");
     ProductFeatures::SetStringFeature("partitioning", "root_base_size", "15 GB");
 
-    include "./tests/helper1b.yh";
+    include "helper1b.yh";
 }
diff --git a/yast2-storage.spec.in b/yast2-storage.spec.in
index 8ae9071..b754e33 100644
--- a/yast2-storage.spec.in
+++ b/yast2-storage.spec.in
@@ -23,6 +23,8 @@ Provides:	yast2-trans-inst-partitioning
 Obsoletes:	yast2-trans-inst-partitioning
 Provides:	y2t_inst-partitioning
 Obsoletes:	y2t_inst-partitioning
+Requires:       yast2-ruby-bindings >= 1.0.0
+
 Summary:	YaST2 - Storage Configuration
 
 %description
@@ -47,26 +49,26 @@ rm -f $RPM_BUILD_ROOT/@plugindir@/libpy2StorageCallbacks.so
 
 # storage
 %dir @yncludedir@/partitioning
-@yncludedir@/partitioning/*.ycp
-@clientdir@/inst_custom_part.ycp
-@clientdir@/inst_resize_ui.ycp
-@clientdir@/inst_resize_dialog.ycp
-@clientdir@/inst_disk.ycp
-@clientdir@/inst_target_part.ycp
-@clientdir@/inst_disk_proposal.ycp
-@clientdir@/inst_target_selection.ycp
-@clientdir@/inst_prepdisk.ycp
-@clientdir@/storage_finish.ycp
-@clientdir@/partitions_proposal.ycp
-@clientdir@/storage.ycp
-@clientdir@/disk.ycp
-@clientdir@/disk_worker.ycp
-@clientdir@/multipath-simple.ycp
+@yncludedir@/partitioning/*.rb
+@clientdir@/inst_custom_part.rb
+@clientdir@/inst_resize_ui.rb
+@clientdir@/inst_resize_dialog.rb
+@clientdir@/inst_disk.rb
+@clientdir@/inst_target_part.rb
+@clientdir@/inst_disk_proposal.rb
+@clientdir@/inst_target_selection.rb
+@clientdir@/inst_prepdisk.rb
+@clientdir@/storage_finish.rb
+@clientdir@/partitions_proposal.rb
+@clientdir@/storage.rb
+@clientdir@/disk.rb
+@clientdir@/disk_worker.rb
+@clientdir@/multipath-simple.rb
 @moduledir@/*
 @fillupdir@/sysconfig.storage-yast2-storage
 
 %dir @ydatadir@
-@ydatadir@/*.ycp
+@ydatadir@/*.rb
 
 %doc %dir @docdir@
 %doc @docdir@/README*
@@ -91,6 +93,7 @@ rm -f $RPM_BUILD_ROOT/@plugindir@/libpy2StorageCallbacks.so
 %package devel
 Requires:	libstorage-devel = %(echo `rpm -q --queryformat '%{VERSION}' libstorage-devel`)
 Requires:       libstdc++-devel yast2-storage = %version
+
 Summary:        YaST2 - Storage Library Headers and Documentation
 Group:          Development/Libraries/YaST
 
@@ -100,5 +103,6 @@ to develop a program using libstorage.
 
 %files devel
 %defattr(-,root,root)
-%doc @docdir@/autodocs
+# TODO ruby autodocs support
+#%doc @docdir@/autodocs
 %doc @docdir@/config.xml.description
