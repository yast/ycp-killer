diff --git a/configure.in.in b/configure.in.in
index eaa7454..b8f73d2 100644
--- a/configure.in.in
+++ b/configure.in.in
@@ -32,6 +32,6 @@ AC_MSG_RESULT([$IFCFG_DIR])
 
 ## and generate the output
 # also done via makefile
-AC_CONFIG_FILES(library/modules/Version.ycp
-library/network/agents/network.scr)
+AC_CONFIG_FILES(library/general/src/modules/Version.rb
+library/network/src/scrconf/network.scr)
 @YAST2-OUTPUT@
diff --git a/data/Makefile.am b/data/Makefile.am
index 55e4a9d..e471c86 100644
--- a/data/Makefile.am
+++ b/data/Makefile.am
@@ -7,12 +7,5 @@ xversiondir = $(sysconfdir)/YaST2
 xversion_DATA =			\
 	XVersion
 
-fillup_DATA =			\
-	sysconfig.yast2
-
-ydata_DATA =                    \
-        country_long.ycp        \
-	country.ycp
-
-EXTRA_DIST = $(xversion_DATA) $(fillup_DATA) $(ydata_DATA)
+EXTRA_DIST = $(xversion_DATA)
 include $(top_srcdir)/Makefile.am.common
diff --git a/library/Makefile.am b/library/Makefile.am
index 5083c46..c85c318 100644
--- a/library/Makefile.am
+++ b/library/Makefile.am
@@ -1,3 +1,3 @@
 # Makefile.am for yast2/library
 
-SUBDIRS = agents types modules runlevel sequencer xml commandline desktop wizard control cwm log system packages cron network gpg
+SUBDIRS = types runlevel sequencer xml commandline desktop wizard control cwm log system packages cron network gpg general
diff --git a/library/agents/Makefile.am b/library/agents/Makefile.am
index 88ef7de..e69de29 100644
--- a/library/agents/Makefile.am
+++ b/library/agents/Makefile.am
@@ -1,12 +0,0 @@
-# Makefile.am for yast2/library/agents
-# $Id$
-
-agent_SCRIPTS =		\
-	ag_content	\
-	ag_netd		\
-	ag_anyxml	\
-	ag_freespace
-
-scrconf_DATA = $(wildcard *.scr)
-
-EXTRA_DIST = $(agent_SCRIPTS) $(scrconf_DATA)
diff --git a/library/commandline/agents/Makefile.am b/library/commandline/agents/Makefile.am
index f495c5f..e69de29 100644
--- a/library/commandline/agents/Makefile.am
+++ b/library/commandline/agents/Makefile.am
@@ -1,9 +0,0 @@
-#
-# Makefile.am for readline agent
-#
-
-agent_SCRIPTS = ag_tty
-
-scrconf_DATA = tty.scr
-
-EXTRA_DIST = $(agent_SCRIPTS) $(scrconf_DATA)
diff --git a/library/commandline/testsuite/Makefile.am b/library/commandline/testsuite/Makefile.am
index d9b12b0..956c637 100644
--- a/library/commandline/testsuite/Makefile.am
+++ b/library/commandline/testsuite/Makefile.am
@@ -5,7 +5,10 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
+
+Y2BASEFLAGS = -I tests
+export Y2BASEFLAGS
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/commandline/testsuite/tests/cmdmap6.ycp b/library/commandline/testsuite/tests/cmdmap6.ycp
index 184a4ed..190f383 100644
--- a/library/commandline/testsuite/tests/cmdmap6.ycp
+++ b/library/commandline/testsuite/tests/cmdmap6.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "TypeRepository";
     import "CommandLine";
diff --git a/library/commandline/testsuite/tests/command1.ycp b/library/commandline/testsuite/tests/command1.ycp
index d0252bc..57d96c0 100644
--- a/library/commandline/testsuite/tests/command1.ycp
+++ b/library/commandline/testsuite/tests/command1.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "TypeRepository";
     import "CommandLine";
diff --git a/library/commandline/testsuite/tests/command2.ycp b/library/commandline/testsuite/tests/command2.ycp
index e0c6823..d1fa598 100644
--- a/library/commandline/testsuite/tests/command2.ycp
+++ b/library/commandline/testsuite/tests/command2.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "TypeRepository";
     import "CommandLine";
diff --git a/library/commandline/testsuite/tests/command3.ycp b/library/commandline/testsuite/tests/command3.ycp
index 6e16b72..d82678c 100644
--- a/library/commandline/testsuite/tests/command3.ycp
+++ b/library/commandline/testsuite/tests/command3.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "TypeRepository";
     import "CommandLine";
diff --git a/library/commandline/testsuite/tests/command4.ycp b/library/commandline/testsuite/tests/command4.ycp
index 8f2bec3..e50cdac 100644
--- a/library/commandline/testsuite/tests/command4.ycp
+++ b/library/commandline/testsuite/tests/command4.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "TypeRepository";
     import "CommandLine";
diff --git a/library/commandline/testsuite/tests/command5.ycp b/library/commandline/testsuite/tests/command5.ycp
index 41eed86..b8f9b29 100644
--- a/library/commandline/testsuite/tests/command5.ycp
+++ b/library/commandline/testsuite/tests/command5.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "CommandLine";
 
diff --git a/library/commandline/testsuite/tests/command6.ycp b/library/commandline/testsuite/tests/command6.ycp
index b784cac..a468295 100644
--- a/library/commandline/testsuite/tests/command6.ycp
+++ b/library/commandline/testsuite/tests/command6.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "CommandLine";
 
diff --git a/library/commandline/testsuite/tests/command7.ycp b/library/commandline/testsuite/tests/command7.ycp
index 7f66dfc..4478c4c 100644
--- a/library/commandline/testsuite/tests/command7.ycp
+++ b/library/commandline/testsuite/tests/command7.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "CommandLine";
 
diff --git a/library/commandline/testsuite/tests/help.ycp b/library/commandline/testsuite/tests/help.ycp
index 29ef271..4ffcf4b 100644
--- a/library/commandline/testsuite/tests/help.ycp
+++ b/library/commandline/testsuite/tests/help.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "TypeRepository";
     import "CommandLine";
diff --git a/library/commandline/testsuite/tests/help1.ycp b/library/commandline/testsuite/tests/help1.ycp
index d291f80..1de1d17 100644
--- a/library/commandline/testsuite/tests/help1.ycp
+++ b/library/commandline/testsuite/tests/help1.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "TypeRepository";
     import "CommandLine";
diff --git a/library/commandline/testsuite/tests/interactive1.ycp b/library/commandline/testsuite/tests/interactive1.ycp
index 2d80566..09f03e5 100644
--- a/library/commandline/testsuite/tests/interactive1.ycp
+++ b/library/commandline/testsuite/tests/interactive1.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "CommandLine";
 
diff --git a/library/commandline/testsuite/tests/interactive2.ycp b/library/commandline/testsuite/tests/interactive2.ycp
index 858004f..dea3f80 100644
--- a/library/commandline/testsuite/tests/interactive2.ycp
+++ b/library/commandline/testsuite/tests/interactive2.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "CommandLine";
 
diff --git a/library/commandline/testsuite/tests/interactive3.ycp b/library/commandline/testsuite/tests/interactive3.ycp
index 6f0c128..fde1506 100644
--- a/library/commandline/testsuite/tests/interactive3.ycp
+++ b/library/commandline/testsuite/tests/interactive3.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "CommandLine";
 
diff --git a/library/commandline/testsuite/tests/interactive4.ycp b/library/commandline/testsuite/tests/interactive4.ycp
index 3d6ad1c..1e8e195 100644
--- a/library/commandline/testsuite/tests/interactive4.ycp
+++ b/library/commandline/testsuite/tests/interactive4.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "CommandLine";
 
diff --git a/library/commandline/testsuite/tests/interactive5.ycp b/library/commandline/testsuite/tests/interactive5.ycp
index 80d1930..797e061 100644
--- a/library/commandline/testsuite/tests/interactive5.ycp
+++ b/library/commandline/testsuite/tests/interactive5.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "CommandLine";
 
diff --git a/library/commandline/testsuite/tests/longhelp.ycp b/library/commandline/testsuite/tests/longhelp.ycp
index 8736e5c..92a7762 100644
--- a/library/commandline/testsuite/tests/longhelp.ycp
+++ b/library/commandline/testsuite/tests/longhelp.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "TypeRepository";
     import "CommandLine";
diff --git a/library/commandline/testsuite/tests/startgui1.ycp b/library/commandline/testsuite/tests/startgui1.ycp
index 6303df6..80d358c 100644
--- a/library/commandline/testsuite/tests/startgui1.ycp
+++ b/library/commandline/testsuite/tests/startgui1.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "TypeRepository";
     import "CommandLine";
diff --git a/library/commandline/testsuite/tests/startgui2.ycp b/library/commandline/testsuite/tests/startgui2.ycp
index a6b9e52..b3bf479 100644
--- a/library/commandline/testsuite/tests/startgui2.ycp
+++ b/library/commandline/testsuite/tests/startgui2.ycp
@@ -33,7 +33,7 @@ you may find current contact information at www.novell.com
 {
 
     include "testsuite.ycp";
-    include "./tests/testsuitedata.yh";
+    include "testsuitedata.yh";
 
     import "TypeRepository";
     import "CommandLine";
diff --git a/library/commandline/testsuite/tests/unique1.ycp b/library/commandline/testsuite/tests/unique1.ycp
index 05a1927..6b948c3 100644
--- a/library/commandline/testsuite/tests/unique1.ycp
+++ b/library/commandline/testsuite/tests/unique1.ycp
@@ -38,8 +38,7 @@ you may find current contact information at www.novell.com
     import "Report";
 
     // disable use of UI
-    Report::display_errors = false;
-    Report::log_errors = true;
+    Report::Import($["errors" : $["show" : false, "log" : true] ]);
 
     // fail: add and delete are mutually exclusive
     TEST(``(CommandLine::UniqueOption($["add":"", "delete":"" ],["add","delete"]) ),[],nil);
diff --git a/library/control/src/modules/ProductControl.ycp b/library/control/src/modules/ProductControl.ycp
index 90bc26e..e4d65d9 100644
--- a/library/control/src/modules/ProductControl.ycp
+++ b/library/control/src/modules/ProductControl.ycp
@@ -565,6 +565,7 @@ void PrepareScripts(map m)
 /**
  * Get list of required files for the workflow.
  * @return list<string> Required files list.
+ * TODO FIXME: this function seems to be unused, remove it?
  */
 global list<string> RequiredFiles (string stage, string mode) 
 {
@@ -595,6 +596,7 @@ global list<string> RequiredFiles (string stage, string mode)
 		client = "inst_" + m["name"]:"dummy";
 	    }
 	}
+        // TODO FIXME: what about the ruby files?
 	client = Directory::clientdir + "/" + client + ".ycp";
 	needed_client_files = add(needed_client_files, client);
     });
diff --git a/library/control/src/modules/WorkflowManager.ycp b/library/control/src/modules/WorkflowManager.ycp
index bc108bd..2fd3356 100644
--- a/library/control/src/modules/WorkflowManager.ycp
+++ b/library/control/src/modules/WorkflowManager.ycp
@@ -528,6 +528,8 @@ test -d '%1' || /bin/mkdir -p '%1';
 
     /**
      * Removes all xml and ycp files from directory where 
+     *
+     * TODO FIXME: this function seems to be unused, remove it?
      */
     global void CleanWorkflowsDirectory () {
 	string directory = GetWorkflowDirectory ();
@@ -537,8 +539,8 @@ test -d '%1' || /bin/mkdir -p '%1';
 	    // doesn't add RPM dependency on tar
 	    map cmd = (map) SCR::Execute (.target.bash_ouptut, "
 cd '%1';
-test -x /bin/tar && /bin/tar -zcf workflows_backup.tgz *.xml *.ycp;
-rm -rf *.xml *.ycp",
+test -x /bin/tar && /bin/tar -zcf workflows_backup.tgz *.xml *.ycp *.rb;
+rm -rf *.xml *.ycp *.rb",
 	    String::Quote (directory));
 
 	    if (cmd["exit"]:-1 != 0) {
diff --git a/library/control/testsuite/Makefile.am b/library/control/testsuite/Makefile.am
index d9b12b0..e85fbc8 100644
--- a/library/control/testsuite/Makefile.am
+++ b/library/control/testsuite/Makefile.am
@@ -5,7 +5,7 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/cwm/testsuite/Makefile.am b/library/cwm/testsuite/Makefile.am
index d9b12b0..956c637 100644
--- a/library/cwm/testsuite/Makefile.am
+++ b/library/cwm/testsuite/Makefile.am
@@ -5,7 +5,10 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
+
+Y2BASEFLAGS = -I tests
+export Y2BASEFLAGS
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/cwm/testsuite/tests/t1.out b/library/cwm/testsuite/tests/t1.out
index a253f1f..3e77037 100644
--- a/library/cwm/testsuite/tests/t1.out
+++ b/library/cwm/testsuite/tests/t1.out
@@ -3,12 +3,12 @@ Dump	==========   Common stuff   ============
 Dump	========================================
 Log	Error on key help of widget w1: Empty help
 Log	Error on key help of widget w2: Empty help
-Dump	W1: $["_cwm_key":"w1", "custom_widget":nil, "handle":<YCPRef:symbol w1_handle (string key, map event)>, "init":<YCPRef:void w1_init (string key)>, "label":"Check&Box", "opt":[`notify, `immediate], "validate_function":<YCPRef:boolean w1_validate (string key, map event)>, "validate_type":`function, "widget":`CheckBox (`id ("w1"), `opt (`notify, `immediate), "Check&Box")]
-Dump	W2: $["_cwm_key":"w2", "custom_widget":nil, "handle":<YCPRef:symbol w2_handle (string key, map event)>, "label":"Text&Entry", "store":<YCPRef:void w2_store (string key, map event)>, "validate_function":<YCPRef:boolean w2_validate (string key, map event)>, "validate_type":`function, "widget":`InputField (`id ("w2"), `opt (`hstretch), "Text&Entry")]
+Dump	W1: $["_cwm_key":"w1", "custom_widget":nil, "handle":<YCPRef:symbol w1_handle (string, map<any,any>)>, "init":<YCPRef:void w1_init (string)>, "label":"Check&Box", "opt":[`notify, `immediate], "validate_function":<YCPRef:boolean w1_validate (string, map<any,any>)>, "validate_type":`function, "widget":`CheckBox (`id ("w1"), `opt (`notify, `immediate), "Check&Box")]
+Dump	W2: $["_cwm_key":"w2", "custom_widget":nil, "handle":<YCPRef:symbol w2_handle (string, map<any,any>)>, "label":"Text&Entry", "store":<YCPRef:void w2_store (string, map<any,any>)>, "validate_function":<YCPRef:boolean w2_validate (string, map<any,any>)>, "validate_type":`function, "widget":`InputField (`id ("w2"), `opt (`hstretch), "Text&Entry")]
 Dump	========================================
 Dump	Merge functions
-Dump	Merged W1: $["_cwm_key":"w1", "custom_widget":nil, "handle":<YCPRef:symbol w1_handle (string key, map event)>, "init":<YCPRef:void w1_init (string key)>, "label":"Check&Box", "opt":[`notify, `immediate], "store":<YCPRef:void generic_save (string key, map event)>, "validate_function":<YCPRef:boolean w1_validate (string key, map event)>, "validate_type":`function, "widget":`CheckBox (`id ("w1"), `opt (`notify, `immediate), "Check&Box")]
-Dump	Merged W2: $["_cwm_key":"w2", "custom_widget":nil, "handle":<YCPRef:symbol w2_handle (string key, map event)>, "init":<YCPRef:void generic_init (string key)>, "label":"Text&Entry", "store":<YCPRef:void w2_store (string key, map event)>, "validate_function":<YCPRef:boolean w2_validate (string key, map event)>, "validate_type":`function, "widget":`InputField (`id ("w2"), `opt (`hstretch), "Text&Entry")]
+Dump	Merged W1: $["_cwm_key":"w1", "custom_widget":nil, "handle":<YCPRef:symbol w1_handle (string, map<any,any>)>, "init":<YCPRef:void w1_init (string)>, "label":"Check&Box", "opt":[`notify, `immediate], "store":<YCPRef:void generic_save (string, map<any,any>)>, "validate_function":<YCPRef:boolean w1_validate (string, map<any,any>)>, "validate_type":`function, "widget":`CheckBox (`id ("w1"), `opt (`notify, `immediate), "Check&Box")]
+Dump	Merged W2: $["_cwm_key":"w2", "custom_widget":nil, "handle":<YCPRef:symbol w2_handle (string, map<any,any>)>, "init":<YCPRef:void generic_init (string)>, "label":"Text&Entry", "store":<YCPRef:void w2_store (string, map<any,any>)>, "validate_function":<YCPRef:boolean w2_validate (string, map<any,any>)>, "validate_type":`function, "widget":`InputField (`id ("w2"), `opt (`hstretch), "Text&Entry")]
 Dump	=========================================
 Dump	Init
 Log	w1_init: Initing w1
diff --git a/library/cwm/testsuite/tests/t1.ycp b/library/cwm/testsuite/tests/t1.ycp
index afa62bb..13ddb6b 100644
--- a/library/cwm/testsuite/tests/t1.ycp
+++ b/library/cwm/testsuite/tests/t1.ycp
@@ -43,10 +43,9 @@ you may find current contact information at www.novell.com
     import "Report";
 
     // disable use of UI
-    Report::display_errors = false;
-    Report::log_errors = true;
+    Report::Import($["errors" : $["show" : false, "log" : true] ]);
 
-    include "./tests/testfunc.yh";
+    include "testfunc.yh";
 
 
     map<string, any> functions = $[
diff --git a/library/cwm/testsuite/tests/t2.out b/library/cwm/testsuite/tests/t2.out
index 4a07e63..d70121d 100644
--- a/library/cwm/testsuite/tests/t2.out
+++ b/library/cwm/testsuite/tests/t2.out
@@ -1,7 +1,7 @@
 Dump	=========================================
 Dump	============   Table/Popup   ============
 Dump	=========================================
-Dump	W: $["_cwm_attrib":$[], "_cwm_do_validate":<YCPRef:boolean ValidateTableDescr (string key, map <string, any> descr)>, "_cwm_key":"table", "custom_widget":nil, "fallback":$["init":<YCPRef:void fallback_init (any id, string key)>, "store":<YCPRef:void fallback_store (any id, string key)>, "summary":<YCPRef:string fallback_summary (any opt_id, string opt_key)>], "handle":<YCPRef:global symbol TablePopup::TableHandleWrapper (string key, map event_descr)>, "help":"<p><b><big>Editing the Settings</big></b><br>\nTo edit the settings, choose the appropriate\nentry of the table then click <b>Edit</b>.</p><p>To add a new option, click <b>Add</b>. To remove\nan option, select it and click <b>Delete</b>.</p>", "id2key":<YCPRef:string id2key (map descr, any opt_id)>, "ids":<YCPRef:list getIdList (map descr)>, "init":<YCPRef:global void TablePopup::TableInitWrapper (string key)>, "options":$["a":$["popup":$["handle":<YCPRef:symbol a_handle (any id, string key, map event)>, "widget":`textentry], "table":$["handle":`a_handle, "label":"'a' option label", "summary":<YCPRef:string opt_sum (any opt_id, string opt_key)>, "widget":`checkbox]], "b":$[]], "widget":`HBox (`HSpacing (2), `VBox (`HBox (`Table (`id (`_tp_table), `opt (`immediate, `notify, `keepSorting), `header ("Option", "Value"), []), `HSpacing (0)), `HBox (`PushButton (`id (`_tp_add), `opt (`key_F3), "&Add"), `PushButton (`id (`_tp_edit), `opt (`key_F4), "Ed&it"), `PushButton (`id (`_tp_delete), `opt (`key_F5), "Dele&te"), `HStretch (), `ReplacePoint (`id (`_tp_table_repl), `HSpacing (0)))), `HSpacing (2))]
+Dump	W: $["_cwm_attrib":$[], "_cwm_do_validate":<YCPRef:boolean ValidateTableDescr (string, map <string, any>)>, "_cwm_key":"table", "custom_widget":nil, "fallback":$["init":<YCPRef:void fallback_init (any, string)>, "store":<YCPRef:void fallback_store (any, string)>, "summary":<YCPRef:string fallback_summary (any, string)>], "handle":<YCPRef:symbol TableHandleWrapper (string, map<any,any>)>, "help":"<p><b><big>Editing the Settings</big></b><br>\nTo edit the settings, choose the appropriate\nentry of the table then click <b>Edit</b>.</p><p>To add a new option, click <b>Add</b>. To remove\nan option, select it and click <b>Delete</b>.</p>", "id2key":<YCPRef:string id2key (map<any,any>, any)>, "ids":<YCPRef:list<any> getIdList (map<any,any>)>, "init":<YCPRef:void TableInitWrapper (string)>, "options":$["a":$["popup":$["handle":<YCPRef:symbol a_handle (any, string, map<any,any>)>, "widget":`textentry], "table":$["handle":`a_handle, "label":"'a' option label", "summary":<YCPRef:string opt_sum (any, string)>, "widget":`checkbox]], "b":$[]], "widget":`HBox (`HSpacing (2), `VBox (`HBox (`Table (`id (`_tp_table), `opt (`immediate, `notify, `keepSorting), `header ("Option", "Value"), []), `HSpacing (0)), `HBox (`PushButton (`id (`_tp_add), `opt (`key_F3), "&Add"), `PushButton (`id (`_tp_edit), `opt (`key_F4), "Ed&it"), `PushButton (`id (`_tp_delete), `opt (`key_F5), "Dele&te"), `HStretch (), `ReplacePoint (`id (`_tp_table_repl), `HSpacing (0)))), `HSpacing (2))]
 Dump	=========================================
 Dump	Init
 Dump	Returning list of ids for table table
@@ -25,11 +25,11 @@ Dump	Popups
 Dump	======
 Dump	========================================
 Dump	Merge functions
-Dump	Before: $["_cwm_key":"a", "popup":$["_cwm_key":"a", "handle":<YCPRef:symbol a_handle (any id, string key, map event)>, "label":"'a' option label", "widget":`textentry], "table":$["_cwm_key":"a", "handle":<YCPRef:symbol a_handle (any id, string key, map event)>, "label":"'a' option label", "summary":<YCPRef:string opt_sum (any opt_id, string opt_key)>, "widget":`checkbox]]
-Dump	After: $["_cwm_key":"a", "popup":$["_cwm_key":"a", "handle":<YCPRef:symbol a_handle (any id, string key, map event)>, "init":<YCPRef:void fallback_init (any id, string key)>, "label":"'a' option label", "store":<YCPRef:void fallback_store (any id, string key)>, "widget":`textentry], "table":$["_cwm_key":"a", "handle":<YCPRef:symbol a_handle (any id, string key, map event)>, "label":"'a' option label", "summary":<YCPRef:string opt_sum (any opt_id, string opt_key)>, "widget":`checkbox]]
+Dump	Before: $["_cwm_key":"a", "popup":$["_cwm_key":"a", "handle":<YCPRef:symbol a_handle (any, string, map<any,any>)>, "label":"'a' option label", "widget":`textentry], "table":$["_cwm_key":"a", "handle":<YCPRef:symbol a_handle (any, string, map<any,any>)>, "label":"'a' option label", "summary":<YCPRef:string opt_sum (any, string)>, "widget":`checkbox]]
+Dump	After: $["_cwm_key":"a", "popup":$["_cwm_key":"a", "handle":<YCPRef:symbol a_handle (any, string, map<any,any>)>, "init":<YCPRef:void fallback_init (any, string)>, "label":"'a' option label", "store":<YCPRef:void fallback_store (any, string)>, "widget":`textentry], "table":$["_cwm_key":"a", "handle":<YCPRef:symbol a_handle (any, string, map<any,any>)>, "label":"'a' option label", "summary":<YCPRef:string opt_sum (any, string)>, "widget":`checkbox]]
 Dump	=========================================
 Dump	Prepare widget
-Dump	Prepared: $["_cwm_key":"a", "custom_widget":nil, "handle":<YCPRef:symbol a_handle (any id, string key, map event)>, "init":<YCPRef:void fallback_init (any id, string key)>, "label":"'a' option label", "store":<YCPRef:void fallback_store (any id, string key)>, "widget":`InputField (`id ("a"), `opt (`hstretch), "'a' option label")]
+Dump	Prepared: $["_cwm_key":"a", "custom_widget":nil, "handle":<YCPRef:symbol a_handle (any, string, map<any,any>)>, "init":<YCPRef:void fallback_init (any, string)>, "label":"'a' option label", "store":<YCPRef:void fallback_store (any, string)>, "widget":`InputField (`id ("a"), `opt (`hstretch), "'a' option label")]
 Dump	=========================================
 Dump	Run popup
 Log	fallback_init: id nil, key a
diff --git a/library/cwm/testsuite/tests/t2.ycp b/library/cwm/testsuite/tests/t2.ycp
index a86971d..8e45382 100644
--- a/library/cwm/testsuite/tests/t2.ycp
+++ b/library/cwm/testsuite/tests/t2.ycp
@@ -48,10 +48,9 @@ you may find current contact information at www.novell.com
     import "Report";
 
     // disable use of UI
-    Report::display_errors = false;
-    Report::log_errors = true;
+    Report::Import($["errors" : $["show" : false, "log" : true] ]);
 
-    include "./tests/testfunc.yh";
+    include "testfunc.yh";
     import "Mode";
 
     Mode::SetTest ("testsuite");
diff --git a/library/general/Makefile.am b/library/general/Makefile.am
index 1f9c470..19a4533 100644
--- a/library/general/Makefile.am
+++ b/library/general/Makefile.am
@@ -1,15 +1,3 @@
-# Makefile.am for yast2/library/modules
+# Makefile.am for library/general
 
-SUBDIRS = . testsuite
-
-module_DATA = $(wildcard *.ycp) $(wildcard *.pm)
-EXTRA_DIST = $(module_DATA) Version.ycp.in
-
-YCPCFLAGS = -M ../types/src
-
-# people are lazy to run Makefile.cvs so let's substitute it
-# also here in addition to configure (#40492)
-Version.ycp: Version.ycp.in ${top_srcdir}/VERSION
-	sed -e "s/\@VERSION\@/`cat ${top_srcdir}/VERSION`/g" $< > $@
-
-include $(top_srcdir)/Makefile.am.common
+SUBDIRS = src testsuite
diff --git a/library/general/src/modules/Version.ycp.in b/library/general/src/modules/Version.ycp.in
index 7111bec..c8b746e 100644
--- a/library/general/src/modules/Version.ycp.in
+++ b/library/general/src/modules/Version.ycp.in
@@ -6,11 +6,11 @@
  *
  * $Id$
  *
- * Version.ycp is a <b>
+ * Version.rb is a <b>
  *
  * ** GENERATED FILE **
  *
- * </b>, so edit Version.ycp.in instead.
+ * </b>, so edit Version.rb.in instead.
  */
 
 {
diff --git a/library/general/testsuite/Makefile.am b/library/general/testsuite/Makefile.am
index d9b12b0..e85fbc8 100644
--- a/library/general/testsuite/Makefile.am
+++ b/library/general/testsuite/Makefile.am
@@ -5,7 +5,7 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/gpg/doc/Makefile.am b/library/gpg/doc/Makefile.am
index f855694..6a765c1 100644
--- a/library/gpg/doc/Makefile.am
+++ b/library/gpg/doc/Makefile.am
@@ -3,6 +3,6 @@
 SUBDIRS = autodocs
 
 htmldir = $(docdir)/gpg
-html_DATA = example.ycp
+html_DATA = example.rb
 
 EXTRA_DIST = $(html_DATA)
diff --git a/library/gpg/testsuite/Makefile.am b/library/gpg/testsuite/Makefile.am
index d9b12b0..e85fbc8 100644
--- a/library/gpg/testsuite/Makefile.am
+++ b/library/gpg/testsuite/Makefile.am
@@ -5,7 +5,7 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/network/agents/Makefile.am b/library/network/agents/Makefile.am
index e368dfd..e69de29 100644
--- a/library/network/agents/Makefile.am
+++ b/library/network/agents/Makefile.am
@@ -1,14 +0,0 @@
-#
-# Makefile.am for network/ifcfg agent
-#
-
-agent_SCRIPTS = ag_showexports
-
-scrconf_DATA = sysconfig_SuSEfirewall2.scr \
-	       network.scr \
-	       net_showexports.scr	
-
-EXTRA_DIST =   sysconfig_SuSEfirewall2.scr \
-			network.scr.in \
-			net_showexports.scr \
-			$(agent_SCRIPTS)
diff --git a/library/network/testsuite/Makefile.am b/library/network/testsuite/Makefile.am
index d9b12b0..e85fbc8 100644
--- a/library/network/testsuite/Makefile.am
+++ b/library/network/testsuite/Makefile.am
@@ -5,7 +5,7 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/packages/testsuite/Makefile.am b/library/packages/testsuite/Makefile.am
index d9b12b0..e85fbc8 100644
--- a/library/packages/testsuite/Makefile.am
+++ b/library/packages/testsuite/Makefile.am
@@ -5,7 +5,7 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/runlevel/testsuite/Makefile.am b/library/runlevel/testsuite/Makefile.am
index d9b12b0..e85fbc8 100644
--- a/library/runlevel/testsuite/Makefile.am
+++ b/library/runlevel/testsuite/Makefile.am
@@ -5,7 +5,7 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/sequencer/testsuite/Makefile.am b/library/sequencer/testsuite/Makefile.am
index d9b12b0..956c637 100644
--- a/library/sequencer/testsuite/Makefile.am
+++ b/library/sequencer/testsuite/Makefile.am
@@ -5,7 +5,10 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
+
+Y2BASEFLAGS = -I tests
+export Y2BASEFLAGS
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/sequencer/testsuite/tests/WS_check.ycp b/library/sequencer/testsuite/tests/WS_check.ycp
index 9e11a70..fe8dd72 100644
--- a/library/sequencer/testsuite/tests/WS_check.ycp
+++ b/library/sequencer/testsuite/tests/WS_check.ycp
@@ -73,7 +73,7 @@ TEST(``(Sequencer::WS_check($[], $[ "ws_start" : `ws_finish ] )), [], nil);
 
 list clicks = nil;
 integer cur = -1;
-include "./tests/Wizard.yh";
+include "Wizard.yh";
 TEST(``(Sequencer::WS_check(aliases(), sequence())), [], nil);
 
 }
diff --git a/library/sequencer/testsuite/tests/Wizard0.ycp b/library/sequencer/testsuite/tests/Wizard0.ycp
index 0ceccbb..6a821b2 100644
--- a/library/sequencer/testsuite/tests/Wizard0.ycp
+++ b/library/sequencer/testsuite/tests/Wizard0.ycp
@@ -23,7 +23,7 @@ you may find current contact information at www.novell.com
 
 list clicks = nil;
 integer cur = -1;
-include "./tests/Wizard.yh";
+include "Wizard.yh";
 
 map Aliases = $[
     "0" : ``(next()),
diff --git a/library/sequencer/testsuite/tests/Wizard1.ycp b/library/sequencer/testsuite/tests/Wizard1.ycp
index 794ec22..e7d6d51 100644
--- a/library/sequencer/testsuite/tests/Wizard1.ycp
+++ b/library/sequencer/testsuite/tests/Wizard1.ycp
@@ -23,6 +23,6 @@ you may find current contact information at www.novell.com
 
 integer cur = 0;
 list clicks = [ `next, `next, `finish ];
-include "./tests/Wizard.yh";
+include "Wizard.yh";
 
 }
diff --git a/library/sequencer/testsuite/tests/Wizard2.ycp b/library/sequencer/testsuite/tests/Wizard2.ycp
index 1ff3486..002207d 100644
--- a/library/sequencer/testsuite/tests/Wizard2.ycp
+++ b/library/sequencer/testsuite/tests/Wizard2.ycp
@@ -23,6 +23,6 @@ you may find current contact information at www.novell.com
 
 integer cur = 0;
 list clicks = [ `next, `details, `next, `finish ];
-include "./tests/Wizard.yh";
+include "Wizard.yh";
 
 }
diff --git a/library/sequencer/testsuite/tests/Wizard3.ycp b/library/sequencer/testsuite/tests/Wizard3.ycp
index 84c4c08..43146c9 100644
--- a/library/sequencer/testsuite/tests/Wizard3.ycp
+++ b/library/sequencer/testsuite/tests/Wizard3.ycp
@@ -23,6 +23,6 @@ you may find current contact information at www.novell.com
 
 integer cur = 0;
 list clicks = [ `next, `details, `details, `next, `finish ];
-include "./tests/Wizard.yh";
+include "Wizard.yh";
 
 }
diff --git a/library/sequencer/testsuite/tests/Wizard4.ycp b/library/sequencer/testsuite/tests/Wizard4.ycp
index 00a0679..54afb0b 100644
--- a/library/sequencer/testsuite/tests/Wizard4.ycp
+++ b/library/sequencer/testsuite/tests/Wizard4.ycp
@@ -23,6 +23,6 @@ you may find current contact information at www.novell.com
 
 integer cur = 0;
 list clicks = [ `next, `expert, `next, `next, `finish ];
-include "./tests/Wizard.yh";
+include "Wizard.yh";
 
 }
diff --git a/library/sequencer/testsuite/tests/Wizard5.ycp b/library/sequencer/testsuite/tests/Wizard5.ycp
index 651d5a7..a297f44 100644
--- a/library/sequencer/testsuite/tests/Wizard5.ycp
+++ b/library/sequencer/testsuite/tests/Wizard5.ycp
@@ -23,6 +23,6 @@ you may find current contact information at www.novell.com
 
 integer cur = 0;
 list clicks = [ `back ];
-include "./tests/Wizard.yh";
+include "Wizard.yh";
 
 }
diff --git a/library/sequencer/testsuite/tests/Wizard6.ycp b/library/sequencer/testsuite/tests/Wizard6.ycp
index a4b4a92..53ca86d 100644
--- a/library/sequencer/testsuite/tests/Wizard6.ycp
+++ b/library/sequencer/testsuite/tests/Wizard6.ycp
@@ -23,6 +23,6 @@ you may find current contact information at www.novell.com
 
 integer cur = 0;
 list clicks = [ `next, `back, `back ];
-include "./tests/Wizard.yh";
+include "Wizard.yh";
 
 }
diff --git a/library/sequencer/testsuite/tests/Wizard7.ycp b/library/sequencer/testsuite/tests/Wizard7.ycp
index a5961f7..780cacf 100644
--- a/library/sequencer/testsuite/tests/Wizard7.ycp
+++ b/library/sequencer/testsuite/tests/Wizard7.ycp
@@ -23,6 +23,6 @@ you may find current contact information at www.novell.com
 
 integer cur = 0;
 list clicks = [ `next, `next, `back, `back, `back ];
-include "./tests/Wizard.yh";
+include "Wizard.yh";
 
 }
diff --git a/library/system/agents/Makefile.am b/library/system/agents/Makefile.am
index 994a636..e69de29 100644
--- a/library/system/agents/Makefile.am
+++ b/library/system/agents/Makefile.am
@@ -1,7 +0,0 @@
-#
-# Makefile.am for y2m_inst/ycp/kernel/agents
-#
-
-scrconf_DATA = $(patsubst $(srcdir)/%,%,$(wildcard $(srcdir)/*.scr))
-
-EXTRA_DIST = $(scrconf_DATA)
diff --git a/library/system/testsuite/Makefile.am b/library/system/testsuite/Makefile.am
index d9b12b0..e85fbc8 100644
--- a/library/system/testsuite/Makefile.am
+++ b/library/system/testsuite/Makefile.am
@@ -5,7 +5,7 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/types/testsuite/Makefile.am b/library/types/testsuite/Makefile.am
index d9b12b0..e85fbc8 100644
--- a/library/types/testsuite/Makefile.am
+++ b/library/types/testsuite/Makefile.am
@@ -5,7 +5,7 @@
 #
 
 AUTOMAKE_OPTIONS = dejagnu
-EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.ycp) $(wildcard tests/*.yh)
+EXTRA_DIST = $(wildcard tests/*.out) $(wildcard tests/*.err) $(wildcard tests/*.rb)
 
 testsuite_prepare = @ydatadir@/testsuite/Makefile.testsuite
 
diff --git a/library/wizard/testsuite/tests/wizard_dialog.ycp b/library/wizard/testsuite/tests/wizard_dialog.ycp
index f8825de..5d58b65 100644
--- a/library/wizard/testsuite/tests/wizard_dialog.ycp
+++ b/library/wizard/testsuite/tests/wizard_dialog.ycp
@@ -23,7 +23,7 @@ you may find current contact information at www.novell.com
   // test wizard_dialog
 
   textdomain "wizard_testsuite";
-  import "./../src/Wizard";
+  import "Wizard";
 
   Wizard::CreateDialog();
   Wizard::SetHelpText( _("<p>This is the example of <tt>CreateWizardDialog()</tt></p>"));
diff --git a/remote/Makefile.am b/remote/Makefile.am
index d4ecbd3..e69de29 100644
--- a/remote/Makefile.am
+++ b/remote/Makefile.am
@@ -1,18 +0,0 @@
-#
-# Makefile.am for yast2/remote
-#
-
-client_DATA =			\
-	password.ycp		\
-	remotechooser.ycp	\
-	remoteinstall.ycp
-
-desktop_DATA = #		\
-	remotechooser.desktop	\
-	remoteinstall.desktop
-
-YCPCFLAGS = -M ../library/modules
-
-EXTRA_DIST = $(client_DATA) # $(desktop_DATA)
-
-include $(top_srcdir)/Makefile.am.common
diff --git a/yast2.spec.in b/yast2.spec.in
index 68b9f1a..d4d9177 100644
--- a/yast2.spec.in
+++ b/yast2.spec.in
@@ -87,6 +87,8 @@ Provides:       yast2-packager:/usr/lib/YaST2/servers_non_y2/ag_anyxml
 Provides:       yast2-dns-server:/usr/share/YaST2/modules/DnsServerAPI.pm
 Provides:       yast2-mail-aliases
 
+Requires:       yast2-ruby-bindings >= 1.0.0
+
 Summary:        YaST2 - Main Package
 
 %description
@@ -180,15 +182,15 @@ mkdir -p "$RPM_BUILD_ROOT"/etc/YaST2
 
 # wizard
 %dir @yncludedir@/wizard
-@yncludedir@/wizard/*.ycp
+@yncludedir@/wizard/*.rb
 
 #packags
 %dir @yncludedir@/packages
-@yncludedir@/packages/*.ycp
+@yncludedir@/packages/*.rb
 
 #system
 %dir @yncludedir@/hwinfo
-@yncludedir@/hwinfo/*.ycp
+@yncludedir@/hwinfo/*.rb
 @desktopdir@/messages.desktop
 
 # documentation
@@ -198,19 +200,19 @@ mkdir -p "$RPM_BUILD_ROOT"/etc/YaST2
 
 %doc @docdir@/autodocs
 %doc @docdir@/commandline
-%doc @docdir@/control
-%doc @docdir@/cron
-%doc @docdir@/cwm
-%doc @docdir@/desktop
+#%doc @docdir@/control
+#%doc @docdir@/cron
+#%doc @docdir@/cwm
+#%doc @docdir@/desktop
 %doc @docdir@/gpg
-%doc @docdir@/log
-%doc @docdir@/network
+#%doc @docdir@/log
+#%doc @docdir@/network
 %doc @docdir@/packages
 %doc @docdir@/runlevel
 %doc @docdir@/sequencer
-%doc @docdir@/system
-%doc @docdir@/types
+#%doc @docdir@/system
+#%doc @docdir@/types
+#%doc @docdir@/xml
 %doc @docdir@/wizard
-%doc @docdir@/xml
 
 %changelog
